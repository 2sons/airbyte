[0m20:37:29.628194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fb76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f6dc30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f6dff0>]}


============================== 20:37:29.631349 | 594b53d6-6443-4eae-9c99-6ed235a946b7 ==============================
[0m20:37:29.631349 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:37:29.631705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '{profiles_dir_path}', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --project-dir=/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project --profiles-dir={profiles_dir_path}', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:37:29.632067 [info ] [MainThread]: dbt version: 1.7.2
[0m20:37:29.632277 [info ] [MainThread]: python version: 3.10.12
[0m20:37:29.632474 [info ] [MainThread]: python path: /Users/ajsteers/.local/pipx/venvs/dbt-duckdb-duckdb/bin/python
[0m20:37:29.632669 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m20:37:29.632881 [info ] [MainThread]: Using profiles dir at {profiles_dir_path}
[0m20:37:29.633074 [info ] [MainThread]: Using profiles.yml file at {profiles_dir_path}/profiles.yml
[0m20:37:29.633268 [info ] [MainThread]: Using dbt_project.yml file at /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/dbt_project.yml
[0m20:37:29.679160 [info ] [MainThread]: Configuration:
[0m20:37:29.679412 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m20:37:29.679624 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:37:29.679825 [info ] [MainThread]: Required dependencies:
[0m20:37:29.680065 [debug] [MainThread]: Executing "git --help"
[0m20:37:29.692513 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:37:29.692927 [debug] [MainThread]: STDERR: "b''"
[0m20:37:29.693158 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:37:29.693377 [info ] [MainThread]: Connection test skipped since no profile was found
[0m20:37:29.693586 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:37:29.693792 [info ] [MainThread]: dbt looked for a profiles.yml file in {profiles_dir_path}/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m20:37:29.695137 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.07960071, "process_user_time": 1.02888, "process_kernel_time": 0.079763, "process_mem_max_rss": "98041856", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:37:29.695540 [debug] [MainThread]: Command `dbt-duckdb debug` failed at 20:37:29.695450 after 0.08 seconds
[0m20:37:29.695815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fb76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100817c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047b1060>]}
[0m20:37:29.696073 [debug] [MainThread]: Flushing usage events
[0m20:37:56.874274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072875e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092bee60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092bf1c0>]}


============================== 20:37:56.876304 | dbe62bbe-c9ba-4615-bb73-503a546e5858 ==============================
[0m20:37:56.876304 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:37:56.876646 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug --project-dir=/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project --profiles-dir=/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:37:56.876981 [info ] [MainThread]: dbt version: 1.7.2
[0m20:37:56.877191 [info ] [MainThread]: python version: 3.10.12
[0m20:37:56.877386 [info ] [MainThread]: python path: /Users/ajsteers/.local/pipx/venvs/dbt-duckdb-duckdb/bin/python
[0m20:37:56.877584 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m20:37:56.996708 [info ] [MainThread]: Using profiles dir at /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project
[0m20:37:56.997116 [info ] [MainThread]: Using profiles.yml file at /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/profiles.yml
[0m20:37:56.997357 [info ] [MainThread]: Using dbt_project.yml file at /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/dbt_project.yml
[0m20:37:56.997820 [info ] [MainThread]: adapter type: duckdb
[0m20:37:56.998076 [info ] [MainThread]: adapter version: 1.7.0
[0m20:37:57.041093 [info ] [MainThread]: Configuration:
[0m20:37:57.041407 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:37:57.041624 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:37:57.041828 [info ] [MainThread]: Required dependencies:
[0m20:37:57.042090 [debug] [MainThread]: Executing "git --help"
[0m20:37:57.053893 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:37:57.054317 [debug] [MainThread]: STDERR: "b''"
[0m20:37:57.054571 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:37:57.054789 [info ] [MainThread]: Connection:
[0m20:37:57.055017 [info ] [MainThread]:   database: dev
[0m20:37:57.055212 [info ] [MainThread]:   schema: main
[0m20:37:57.055404 [info ] [MainThread]:   path: dev.duckdb
[0m20:37:57.055595 [info ] [MainThread]:   config_options: None
[0m20:37:57.055783 [info ] [MainThread]:   extensions: None
[0m20:37:57.055970 [info ] [MainThread]:   settings: None
[0m20:37:57.056156 [info ] [MainThread]:   external_root: .
[0m20:37:57.056348 [info ] [MainThread]:   use_credential_provider: None
[0m20:37:57.056532 [info ] [MainThread]:   attach: None
[0m20:37:57.056726 [info ] [MainThread]:   filesystems: None
[0m20:37:57.056912 [info ] [MainThread]:   remote: None
[0m20:37:57.057095 [info ] [MainThread]:   plugins: None
[0m20:37:57.057281 [info ] [MainThread]:   disable_transactions: False
[0m20:37:57.057612 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m20:37:57.060694 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m20:37:57.061093 [debug] [MainThread]: Using duckdb connection "debug"
[0m20:37:57.061305 [debug] [MainThread]: On debug: select 1 as id
[0m20:37:57.061519 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:37:57.070993 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:37:57.071916 [debug] [MainThread]: On debug: Close
[0m20:37:57.073106 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:37:57.073346 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:37:57.074243 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.2297725, "process_user_time": 1.125156, "process_kernel_time": 0.097562, "process_mem_max_rss": "114589696", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:37:57.074660 [debug] [MainThread]: Command `dbt-duckdb debug` succeeded at 20:37:57.074571 after 0.23 seconds
[0m20:37:57.074901 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:37:57.075157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072875e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10923e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092bc0d0>]}
[0m20:37:57.075453 [debug] [MainThread]: Flushing usage events
[0m20:48:02.453948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028eb700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10539aef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10539b250>]}


============================== 20:48:02.456900 | eb7ac56b-16f0-4d1a-810b-9f1ff00887fd ==============================
[0m20:48:02.456900 [info ] [MainThread]: Running with dbt=1.7.2
[0m20:48:02.457313 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --project-dir=/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project --profiles-dir=/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'send_anonymous_usage_stats': 'True'}
[0m20:48:02.457683 [info ] [MainThread]: dbt version: 1.7.2
[0m20:48:02.457919 [info ] [MainThread]: python version: 3.10.12
[0m20:48:02.458136 [info ] [MainThread]: python path: /Users/ajsteers/.local/pipx/venvs/dbt-duckdb-duckdb/bin/python
[0m20:48:02.458342 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m20:48:02.571252 [info ] [MainThread]: Using profiles dir at /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project
[0m20:48:02.571551 [info ] [MainThread]: Using profiles.yml file at /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/profiles.yml
[0m20:48:02.571787 [info ] [MainThread]: Using dbt_project.yml file at /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/dbt_project.yml
[0m20:48:02.572142 [info ] [MainThread]: adapter type: duckdb
[0m20:48:02.572358 [info ] [MainThread]: adapter version: 1.7.0
[0m20:48:02.610660 [info ] [MainThread]: Configuration:
[0m20:48:02.610905 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:48:02.611111 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:48:02.611314 [info ] [MainThread]: Required dependencies:
[0m20:48:02.611547 [debug] [MainThread]: Executing "git --help"
[0m20:48:02.624277 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:48:02.624694 [debug] [MainThread]: STDERR: "b''"
[0m20:48:02.624921 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:48:02.625143 [info ] [MainThread]: Connection:
[0m20:48:02.625364 [info ] [MainThread]:   database: dev
[0m20:48:02.625561 [info ] [MainThread]:   schema: main
[0m20:48:02.625752 [info ] [MainThread]:   path: dev.duckdb
[0m20:48:02.625942 [info ] [MainThread]:   config_options: None
[0m20:48:02.626130 [info ] [MainThread]:   extensions: None
[0m20:48:02.626319 [info ] [MainThread]:   settings: None
[0m20:48:02.626504 [info ] [MainThread]:   external_root: .
[0m20:48:02.626691 [info ] [MainThread]:   use_credential_provider: None
[0m20:48:02.626879 [info ] [MainThread]:   attach: None
[0m20:48:02.627064 [info ] [MainThread]:   filesystems: None
[0m20:48:02.627250 [info ] [MainThread]:   remote: None
[0m20:48:02.627433 [info ] [MainThread]:   plugins: None
[0m20:48:02.627618 [info ] [MainThread]:   disable_transactions: False
[0m20:48:02.627929 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m20:48:02.630611 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m20:48:02.631008 [debug] [MainThread]: Using duckdb connection "debug"
[0m20:48:02.631217 [debug] [MainThread]: On debug: select 1 as id
[0m20:48:02.631415 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:48:02.640408 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m20:48:02.641156 [debug] [MainThread]: On debug: Close
[0m20:48:02.642359 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:48:02.642605 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:48:02.643654 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.22015008, "process_user_time": 1.130795, "process_kernel_time": 0.11207, "process_mem_max_rss": "117964800", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:48:02.644082 [debug] [MainThread]: Command `dbt-duckdb debug` succeeded at 20:48:02.643989 after 0.22 seconds
[0m20:48:02.644316 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:48:02.644571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028eb700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056ce230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105606980>]}
[0m20:48:02.644854 [debug] [MainThread]: Flushing usage events
[0m22:08:02.921236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103763640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10579efb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10579f310>]}


============================== 22:08:02.924572 | c346254e-fb44-47a1-ba86-c3292c41c2ce ==============================
[0m22:08:02.924572 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:08:02.924945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'debug': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir=/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project --profiles-dir=/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:08:03.086106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c346254e-fb44-47a1-ba86-c3292c41c2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10579f460>]}
[0m22:08:03.132094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c346254e-fb44-47a1-ba86-c3292c41c2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a31210>]}
[0m22:08:03.132569 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m22:08:03.140662 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m22:08:03.141114 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:08:03.141393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c346254e-fb44-47a1-ba86-c3292c41c2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105851060>]}
[0m22:08:03.709263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c346254e-fb44-47a1-ba86-c3292c41c2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e9c0d0>]}
[0m22:08:03.714747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c346254e-fb44-47a1-ba86-c3292c41c2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cda140>]}
[0m22:08:03.715026 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m22:08:03.715259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c346254e-fb44-47a1-ba86-c3292c41c2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d3fc40>]}
[0m22:08:03.716016 [info ] [MainThread]: 
[0m22:08:03.716426 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:08:03.716980 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m22:08:03.723018 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m22:08:03.723246 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m22:08:03.723442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:03.730379 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:03.731661 [debug] [ThreadPool]: On list_dev: Close
[0m22:08:03.733136 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m22:08:03.733505 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m22:08:03.735835 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:08:03.736056 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m22:08:03.736249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:03.738318 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:03.738522 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:08:03.738740 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "connection_name": "create_dev_main"} */
create schema if not exists "dev"."main"
[0m22:08:03.739058 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:03.739530 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m22:08:03.739736 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m22:08:03.739921 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m22:08:03.740137 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:03.740325 [debug] [ThreadPool]: On create_dev_main: Close
[0m22:08:03.741750 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m22:08:03.744661 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m22:08:03.744886 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m22:08:03.745080 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:03.747191 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:03.747409 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m22:08:03.747613 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m22:08:03.757793 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m22:08:03.760500 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m22:08:03.761094 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m22:08:03.761299 [debug] [ThreadPool]: On list_dev_main: Close
[0m22:08:03.762589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c346254e-fb44-47a1-ba86-c3292c41c2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f03640>]}
[0m22:08:03.762847 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:03.763042 [debug] [MainThread]: On master: BEGIN
[0m22:08:03.763222 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:08:03.765240 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:08:03.765441 [debug] [MainThread]: On master: COMMIT
[0m22:08:03.765629 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:03.765813 [debug] [MainThread]: On master: COMMIT
[0m22:08:03.766016 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:08:03.766201 [debug] [MainThread]: On master: Close
[0m22:08:03.767152 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:08:03.767376 [info ] [MainThread]: 
[0m22:08:03.768477 [debug] [Thread-1 (]: Began running node model.duckdb_sample_project.my_first_dbt_model
[0m22:08:03.768799 [info ] [Thread-1 (]: 1 of 2 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m22:08:03.769188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.duckdb_sample_project.my_first_dbt_model)
[0m22:08:03.769415 [debug] [Thread-1 (]: Began compiling node model.duckdb_sample_project.my_first_dbt_model
[0m22:08:03.773473 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_sample_project.my_first_dbt_model"
[0m22:08:03.774063 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_first_dbt_model (compile): 22:08:03.769557 => 22:08:03.773923
[0m22:08:03.774315 [debug] [Thread-1 (]: Began executing node model.duckdb_sample_project.my_first_dbt_model
[0m22:08:03.792402 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_sample_project.my_first_dbt_model"
[0m22:08:03.792953 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m22:08:03.793183 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: BEGIN
[0m22:08:03.793405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:03.795476 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:03.795710 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m22:08:03.795949 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m22:08:03.797655 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:03.800981 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m22:08:03.801243 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m22:08:03.801829 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:03.811350 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: COMMIT
[0m22:08:03.811617 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m22:08:03.811850 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: COMMIT
[0m22:08:03.813367 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:03.816129 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m22:08:03.816368 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m22:08:03.816645 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:03.817403 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_first_dbt_model (execute): 22:08:03.774470 => 22:08:03.817284
[0m22:08:03.817631 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: Close
[0m22:08:03.819755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c346254e-fb44-47a1-ba86-c3292c41c2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e99360>]}
[0m22:08:03.820103 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m22:08:03.820442 [debug] [Thread-1 (]: Finished running node model.duckdb_sample_project.my_first_dbt_model
[0m22:08:03.820849 [debug] [Thread-1 (]: Began running node model.duckdb_sample_project.my_second_dbt_model
[0m22:08:03.821186 [info ] [Thread-1 (]: 2 of 2 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m22:08:03.821563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.duckdb_sample_project.my_first_dbt_model, now model.duckdb_sample_project.my_second_dbt_model)
[0m22:08:03.821785 [debug] [Thread-1 (]: Began compiling node model.duckdb_sample_project.my_second_dbt_model
[0m22:08:03.823254 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_sample_project.my_second_dbt_model"
[0m22:08:03.823647 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_second_dbt_model (compile): 22:08:03.821931 => 22:08:03.823516
[0m22:08:03.823891 [debug] [Thread-1 (]: Began executing node model.duckdb_sample_project.my_second_dbt_model
[0m22:08:03.833764 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_sample_project.my_second_dbt_model"
[0m22:08:03.834155 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m22:08:03.834387 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: BEGIN
[0m22:08:03.834608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:03.836818 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:03.837057 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m22:08:03.837282 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m22:08:03.837570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:03.839688 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m22:08:03.839925 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m22:08:03.840194 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:03.841067 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: COMMIT
[0m22:08:03.841285 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m22:08:03.841492 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: COMMIT
[0m22:08:03.842022 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:03.843405 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m22:08:03.843636 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m22:08:03.843899 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m22:08:03.844654 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_second_dbt_model (execute): 22:08:03.824046 => 22:08:03.844539
[0m22:08:03.844879 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: Close
[0m22:08:03.846096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c346254e-fb44-47a1-ba86-c3292c41c2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fac4c0>]}
[0m22:08:03.846418 [info ] [Thread-1 (]: 2 of 2 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.02s]
[0m22:08:03.846744 [debug] [Thread-1 (]: Finished running node model.duckdb_sample_project.my_second_dbt_model
[0m22:08:03.847373 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:03.847571 [debug] [MainThread]: On master: BEGIN
[0m22:08:03.847756 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:08:03.849895 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:08:03.850105 [debug] [MainThread]: On master: COMMIT
[0m22:08:03.850294 [debug] [MainThread]: Using duckdb connection "master"
[0m22:08:03.850477 [debug] [MainThread]: On master: COMMIT
[0m22:08:03.850679 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m22:08:03.850864 [debug] [MainThread]: On master: Close
[0m22:08:03.851832 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:08:03.852035 [debug] [MainThread]: Connection 'model.duckdb_sample_project.my_second_dbt_model' was properly closed.
[0m22:08:03.852239 [info ] [MainThread]: 
[0m22:08:03.852463 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m22:08:03.852883 [debug] [MainThread]: Command end result
[0m22:08:03.856816 [info ] [MainThread]: 
[0m22:08:03.857056 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:08:03.857261 [info ] [MainThread]: 
[0m22:08:03.857473 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:08:03.858512 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.97000486, "process_user_time": 1.856088, "process_kernel_time": 0.145186, "process_mem_max_rss": "134529024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:08:03.858827 [debug] [MainThread]: Command `dbt-duckdb run` succeeded at 22:08:03.858752 after 0.97 seconds
[0m22:08:03.859048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103763640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cc96f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f0f190>]}
[0m22:08:03.859272 [debug] [MainThread]: Flushing usage events
[0m22:32:28.960210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103387640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10559afb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10559b310>]}


============================== 22:32:28.963361 | ee844372-baad-430b-8bad-1b8a402bb17a ==============================
[0m22:32:28.963361 [info ] [MainThread]: Running with dbt=1.7.2
[0m22:32:28.963743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir=/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project --profiles-dir=/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:32:28.966435 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DUCKDB_PARENT_DIR'
[0m22:32:28.967442 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.037897207, "process_user_time": 1.021815, "process_kernel_time": 0.091497, "process_mem_max_rss": "98664448", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:32:28.967782 [debug] [MainThread]: Command `dbt-duckdb run` failed at 22:32:28.967703 after 0.04 seconds
[0m22:32:28.968002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103387640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10551b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10551a950>]}
[0m22:32:28.968227 [debug] [MainThread]: Flushing usage events
[0m07:58:37.593730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c3760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093fb010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093fb370>]}


============================== 07:58:37.597084 | b47e7244-bcac-48ea-a9dc-40276ce4199c ==============================
[0m07:58:37.597084 [info ] [MainThread]: Running with dbt=1.7.2
[0m07:58:37.597479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir=/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project --profiles-dir=/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:58:37.600276 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DUCKDB_PARENT_DIR'
[0m07:58:37.601285 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.04330025, "process_user_time": 1.015293, "process_kernel_time": 0.093346, "process_mem_max_rss": "97386496", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:58:37.601637 [debug] [MainThread]: Command `dbt-duckdb run` failed at 07:58:37.601558 after 0.04 seconds
[0m07:58:37.601855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c3760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10937add0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109378ee0>]}
[0m07:58:37.602077 [debug] [MainThread]: Flushing usage events
[0m10:18:54.739236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b87700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d9b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d9b370>]}


============================== 10:18:54.741692 | 5baec15d-9a93-4bd3-995e-054456d71eb3 ==============================
[0m10:18:54.741692 [info ] [MainThread]: Running with dbt=1.7.2
[0m10:18:54.742042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir=/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project --profiles-dir=/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:18:54.744879 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DUCKDB_DB_DIR'
[0m10:18:54.745843 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.040330082, "process_user_time": 1.025058, "process_kernel_time": 0.094016, "process_mem_max_rss": "97714176", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:18:54.746183 [debug] [MainThread]: Command `dbt-duckdb run` failed at 10:18:54.746102 after 0.04 seconds
[0m10:18:54.746404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b87700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d1add0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d1aef0>]}
[0m10:18:54.746644 [debug] [MainThread]: Flushing usage events
[0m10:51:44.674844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd7700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a9f220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a9f580>]}


============================== 10:51:44.678041 | cdebf4ca-795d-4ef5-a528-c8f44a4a825d ==============================
[0m10:51:44.678041 [info ] [MainThread]: Running with dbt=1.7.2
[0m10:51:44.678477 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir=/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project --profiles-dir=/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:51:44.681494 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DUCKDB_DB_DIR'
[0m10:51:44.682997 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.042478666, "process_user_time": 1.071447, "process_kernel_time": 0.097968, "process_mem_max_rss": "98107392", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:51:44.683354 [debug] [MainThread]: Command `dbt-duckdb run` failed at 10:51:44.683266 after 0.04 seconds
[0m10:51:44.683616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd7700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a17670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a16080>]}
[0m10:51:44.683884 [debug] [MainThread]: Flushing usage events
[0m13:39:13.982433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109371660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6a3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6a3c10>]}


============================== 13:39:13.985580 | afb559a2-ee97-4590-8cef-f34eaaf4bd3d ==============================
[0m13:39:13.985580 [info ] [MainThread]: Running with dbt=1.7.2
[0m13:39:13.985983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'debug': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:39:14.509582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afb559a2-ee97-4590-8cef-f34eaaf4bd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5d94e0>]}
[0m13:39:14.560699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afb559a2-ee97-4590-8cef-f34eaaf4bd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b72b3a0>]}
[0m13:39:14.561767 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m13:39:14.571929 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m13:39:14.578104 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:39:14.578408 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m13:39:14.578671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'afb559a2-ee97-4590-8cef-f34eaaf4bd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b932b00>]}
[0m13:39:15.049121 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m13:39:15.058082 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m13:39:15.188439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afb559a2-ee97-4590-8cef-f34eaaf4bd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be078e0>]}
[0m13:39:15.194996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afb559a2-ee97-4590-8cef-f34eaaf4bd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be079a0>]}
[0m13:39:15.195313 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m13:39:15.195582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afb559a2-ee97-4590-8cef-f34eaaf4bd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be07ac0>]}
[0m13:39:15.196445 [info ] [MainThread]: 
[0m13:39:15.196895 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:39:15.197515 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:39:15.203941 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:39:15.204227 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m13:39:15.204488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:15.209824 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:39:15.210758 [debug] [ThreadPool]: On list_dev: Close
[0m13:39:15.212019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:39:15.212458 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:39:15.215020 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:39:15.215247 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:39:15.215467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:15.217580 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:39:15.217818 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:39:15.218027 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "connection_name": "create_dev_main"} */
create schema if not exists "dev"."main"
[0m13:39:15.218340 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:39:15.218851 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:39:15.219061 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:39:15.219256 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:39:15.219490 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:39:15.219690 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:39:15.221208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:39:15.224224 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:39:15.224454 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:39:15.224651 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:15.226634 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:39:15.226868 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:39:15.227097 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m13:39:15.236622 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:39:15.239138 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:39:15.240187 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:39:15.240416 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:39:15.241780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afb559a2-ee97-4590-8cef-f34eaaf4bd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be0f0d0>]}
[0m13:39:15.242071 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:15.242276 [debug] [MainThread]: On master: BEGIN
[0m13:39:15.242471 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:39:15.244544 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:39:15.244784 [debug] [MainThread]: On master: COMMIT
[0m13:39:15.245001 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:15.245211 [debug] [MainThread]: On master: COMMIT
[0m13:39:15.245452 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:39:15.245661 [debug] [MainThread]: On master: Close
[0m13:39:15.246722 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:39:15.246999 [info ] [MainThread]: 
[0m13:39:15.248256 [debug] [Thread-1 (]: Began running node model.duckdb_sample_project.my_first_dbt_model
[0m13:39:15.248575 [info ] [Thread-1 (]: 1 of 2 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m13:39:15.248991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.duckdb_sample_project.my_first_dbt_model)
[0m13:39:15.249223 [debug] [Thread-1 (]: Began compiling node model.duckdb_sample_project.my_first_dbt_model
[0m13:39:15.254154 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_sample_project.my_first_dbt_model"
[0m13:39:15.254692 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_first_dbt_model (compile): 13:39:15.249375 => 13:39:15.254551
[0m13:39:15.254954 [debug] [Thread-1 (]: Began executing node model.duckdb_sample_project.my_first_dbt_model
[0m13:39:15.273985 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_sample_project.my_first_dbt_model"
[0m13:39:15.274522 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m13:39:15.274780 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: BEGIN
[0m13:39:15.275021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:15.277431 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:15.277706 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m13:39:15.277986 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m13:39:15.278839 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:15.282507 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m13:39:15.282768 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:39:15.283116 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:15.292998 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: COMMIT
[0m13:39:15.293289 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m13:39:15.293536 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: COMMIT
[0m13:39:15.294036 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:15.296825 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m13:39:15.297088 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m13:39:15.297389 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:15.298191 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_first_dbt_model (execute): 13:39:15.255111 => 13:39:15.298058
[0m13:39:15.298439 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: Close
[0m13:39:15.300085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afb559a2-ee97-4590-8cef-f34eaaf4bd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b91d2d0>]}
[0m13:39:15.300470 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m13:39:15.300846 [debug] [Thread-1 (]: Finished running node model.duckdb_sample_project.my_first_dbt_model
[0m13:39:15.301345 [debug] [Thread-1 (]: Began running node model.duckdb_sample_project.my_second_dbt_model
[0m13:39:15.301689 [info ] [Thread-1 (]: 2 of 2 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m13:39:15.302131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.duckdb_sample_project.my_first_dbt_model, now model.duckdb_sample_project.my_second_dbt_model)
[0m13:39:15.302387 [debug] [Thread-1 (]: Began compiling node model.duckdb_sample_project.my_second_dbt_model
[0m13:39:15.303954 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_sample_project.my_second_dbt_model"
[0m13:39:15.304414 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_second_dbt_model (compile): 13:39:15.302550 => 13:39:15.304268
[0m13:39:15.304675 [debug] [Thread-1 (]: Began executing node model.duckdb_sample_project.my_second_dbt_model
[0m13:39:15.315863 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_sample_project.my_second_dbt_model"
[0m13:39:15.316343 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m13:39:15.316605 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: BEGIN
[0m13:39:15.316831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:15.319211 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:15.319477 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m13:39:15.319735 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m13:39:15.320090 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:15.321947 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m13:39:15.322203 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:39:15.322490 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:15.323407 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: COMMIT
[0m13:39:15.323660 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m13:39:15.323885 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: COMMIT
[0m13:39:15.324245 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:15.325678 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m13:39:15.325972 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m13:39:15.326248 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:15.327034 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_second_dbt_model (execute): 13:39:15.304842 => 13:39:15.326901
[0m13:39:15.327287 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: Close
[0m13:39:15.328660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afb559a2-ee97-4590-8cef-f34eaaf4bd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfbfdc0>]}
[0m13:39:15.329083 [info ] [Thread-1 (]: 2 of 2 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.03s]
[0m13:39:15.329473 [debug] [Thread-1 (]: Finished running node model.duckdb_sample_project.my_second_dbt_model
[0m13:39:15.330156 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:15.330383 [debug] [MainThread]: On master: BEGIN
[0m13:39:15.330595 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:39:15.332992 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:39:15.333216 [debug] [MainThread]: On master: COMMIT
[0m13:39:15.333422 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:15.333627 [debug] [MainThread]: On master: COMMIT
[0m13:39:15.333849 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:39:15.334069 [debug] [MainThread]: On master: Close
[0m13:39:15.335196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:39:15.335493 [debug] [MainThread]: Connection 'model.duckdb_sample_project.my_second_dbt_model' was properly closed.
[0m13:39:15.335741 [info ] [MainThread]: 
[0m13:39:15.335985 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m13:39:15.336431 [debug] [MainThread]: Command end result
[0m13:39:15.340688 [info ] [MainThread]: 
[0m13:39:15.340962 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:39:15.341179 [info ] [MainThread]: 
[0m13:39:15.341403 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:39:15.342802 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.396608, "process_user_time": 2.10732, "process_kernel_time": 0.160551, "process_mem_max_rss": "154501120", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:39:15.343224 [debug] [MainThread]: Command `cli run` succeeded at 13:39:15.343132 after 1.40 seconds
[0m13:39:15.343499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109371660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd6cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfbf820>]}
[0m13:39:15.343766 [debug] [MainThread]: Flushing usage events
[0m13:54:03.647724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10581d8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11045f040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11045fc70>]}


============================== 13:54:03.651363 | 216c8691-9f90-4856-9536-7473aefbd1e9 ==============================
[0m13:54:03.651363 [info ] [MainThread]: Running with dbt=1.7.2
[0m13:54:03.651795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'debug': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:54:03.865067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '216c8691-9f90-4856-9536-7473aefbd1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104dfd30>]}
[0m13:54:03.914677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '216c8691-9f90-4856-9536-7473aefbd1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107dcf70>]}
[0m13:54:03.915506 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m13:54:03.925927 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m13:54:03.955963 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:54:03.956235 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:54:03.959583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '216c8691-9f90-4856-9536-7473aefbd1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aae470>]}
[0m13:54:03.965877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '216c8691-9f90-4856-9536-7473aefbd1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a89750>]}
[0m13:54:03.966178 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m13:54:03.966440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '216c8691-9f90-4856-9536-7473aefbd1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a89690>]}
[0m13:54:03.967391 [info ] [MainThread]: 
[0m13:54:03.967856 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:54:03.968580 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:54:03.975383 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:54:03.975671 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m13:54:03.975913 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:03.988548 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:03.990603 [debug] [ThreadPool]: On list_dev: Close
[0m13:54:03.992157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:54:03.992571 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:54:03.995114 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:54:03.995361 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:54:03.995578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:03.997871 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:03.998101 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:54:03.998318 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "connection_name": "create_dev_main"} */
create schema if not exists "dev"."main"
[0m13:54:03.998801 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:03.999302 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:54:03.999522 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:54:03.999731 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:54:03.999970 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:04.000180 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:54:04.001722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:54:04.004815 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:54:04.005059 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:54:04.005263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:04.007549 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:04.007779 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:54:04.008000 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m13:54:04.019734 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:04.022778 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:54:04.023873 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:54:04.024109 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:54:04.025659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '216c8691-9f90-4856-9536-7473aefbd1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a9f850>]}
[0m13:54:04.025946 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:04.026157 [debug] [MainThread]: On master: BEGIN
[0m13:54:04.026353 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:54:04.028506 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:54:04.028749 [debug] [MainThread]: On master: COMMIT
[0m13:54:04.028958 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:04.029156 [debug] [MainThread]: On master: COMMIT
[0m13:54:04.029373 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:54:04.029571 [debug] [MainThread]: On master: Close
[0m13:54:04.030522 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:54:04.030781 [info ] [MainThread]: 
[0m13:54:04.032033 [debug] [Thread-1 (]: Began running node model.duckdb_sample_project.my_first_dbt_model
[0m13:54:04.032358 [info ] [Thread-1 (]: 1 of 2 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m13:54:04.032769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.duckdb_sample_project.my_first_dbt_model)
[0m13:54:04.033025 [debug] [Thread-1 (]: Began compiling node model.duckdb_sample_project.my_first_dbt_model
[0m13:54:04.037242 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_sample_project.my_first_dbt_model"
[0m13:54:04.037730 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_first_dbt_model (compile): 13:54:04.033182 => 13:54:04.037582
[0m13:54:04.037997 [debug] [Thread-1 (]: Began executing node model.duckdb_sample_project.my_first_dbt_model
[0m13:54:04.057691 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_sample_project.my_first_dbt_model"
[0m13:54:04.058231 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m13:54:04.058498 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: BEGIN
[0m13:54:04.058748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:04.061369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:04.061638 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m13:54:04.061902 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m13:54:04.063917 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:04.067359 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m13:54:04.067635 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m13:54:04.067989 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:04.069700 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m13:54:04.070002 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:54:04.070313 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:04.081515 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: COMMIT
[0m13:54:04.081803 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m13:54:04.082049 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: COMMIT
[0m13:54:04.082821 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:04.085751 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m13:54:04.086034 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m13:54:04.086600 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:04.087452 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_first_dbt_model (execute): 13:54:04.038157 => 13:54:04.087318
[0m13:54:04.087716 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: Close
[0m13:54:04.089727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '216c8691-9f90-4856-9536-7473aefbd1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b13e80>]}
[0m13:54:04.090112 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m13:54:04.090493 [debug] [Thread-1 (]: Finished running node model.duckdb_sample_project.my_first_dbt_model
[0m13:54:04.090936 [debug] [Thread-1 (]: Began running node model.duckdb_sample_project.my_second_dbt_model
[0m13:54:04.091275 [info ] [Thread-1 (]: 2 of 2 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m13:54:04.091674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.duckdb_sample_project.my_first_dbt_model, now model.duckdb_sample_project.my_second_dbt_model)
[0m13:54:04.091931 [debug] [Thread-1 (]: Began compiling node model.duckdb_sample_project.my_second_dbt_model
[0m13:54:04.093584 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_sample_project.my_second_dbt_model"
[0m13:54:04.094035 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_second_dbt_model (compile): 13:54:04.092086 => 13:54:04.093897
[0m13:54:04.094291 [debug] [Thread-1 (]: Began executing node model.duckdb_sample_project.my_second_dbt_model
[0m13:54:04.105224 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_sample_project.my_second_dbt_model"
[0m13:54:04.105667 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m13:54:04.105919 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: BEGIN
[0m13:54:04.106153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:04.108744 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:04.109030 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m13:54:04.109289 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m13:54:04.109640 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:04.111523 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m13:54:04.111792 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m13:54:04.112101 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:04.113829 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m13:54:04.114090 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:54:04.114383 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:04.115582 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: COMMIT
[0m13:54:04.115833 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m13:54:04.116074 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: COMMIT
[0m13:54:04.116467 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:04.117950 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m13:54:04.118211 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m13:54:04.118549 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:04.119319 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_second_dbt_model (execute): 13:54:04.094449 => 13:54:04.119192
[0m13:54:04.119573 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: Close
[0m13:54:04.120966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '216c8691-9f90-4856-9536-7473aefbd1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bcb940>]}
[0m13:54:04.121363 [info ] [Thread-1 (]: 2 of 2 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.03s]
[0m13:54:04.121745 [debug] [Thread-1 (]: Finished running node model.duckdb_sample_project.my_second_dbt_model
[0m13:54:04.122472 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:04.122728 [debug] [MainThread]: On master: BEGIN
[0m13:54:04.122952 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:54:04.125421 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:54:04.125658 [debug] [MainThread]: On master: COMMIT
[0m13:54:04.125874 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:04.126093 [debug] [MainThread]: On master: COMMIT
[0m13:54:04.126328 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:54:04.126545 [debug] [MainThread]: On master: Close
[0m13:54:04.127584 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:04.127846 [debug] [MainThread]: Connection 'model.duckdb_sample_project.my_second_dbt_model' was properly closed.
[0m13:54:04.128102 [info ] [MainThread]: 
[0m13:54:04.128366 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m13:54:04.128840 [debug] [MainThread]: Command end result
[0m13:54:04.133306 [info ] [MainThread]: 
[0m13:54:04.133639 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:54:04.133898 [info ] [MainThread]: 
[0m13:54:04.134149 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:54:04.135735 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5245781, "process_user_time": 1.576768, "process_kernel_time": 0.151734, "process_mem_max_rss": "147488768", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:54:04.136087 [debug] [MainThread]: Command `cli run` succeeded at 13:54:04.136007 after 0.52 seconds
[0m13:54:04.136397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10581d8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b0b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b0b460>]}
[0m13:54:04.136680 [debug] [MainThread]: Flushing usage events
[0m13:55:41.195285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10421d870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10675ef80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10675fcd0>]}


============================== 13:55:41.198593 | 46a1df13-fad8-47af-90c4-a6f8d9f08ab4 ==============================
[0m13:55:41.198593 [info ] [MainThread]: Running with dbt=1.7.2
[0m13:55:41.198985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:55:41.393158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46a1df13-fad8-47af-90c4-a6f8d9f08ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106695270>]}
[0m13:55:41.441046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46a1df13-fad8-47af-90c4-a6f8d9f08ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072dd2a0>]}
[0m13:55:41.441871 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m13:55:41.451758 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m13:55:41.480257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:41.480549 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:41.483962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46a1df13-fad8-47af-90c4-a6f8d9f08ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074ae4d0>]}
[0m13:55:41.490094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46a1df13-fad8-47af-90c4-a6f8d9f08ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107489720>]}
[0m13:55:41.490391 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m13:55:41.490654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46a1df13-fad8-47af-90c4-a6f8d9f08ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107489600>]}
[0m13:55:41.491569 [info ] [MainThread]: 
[0m13:55:41.492024 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:55:41.492686 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:55:41.499464 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:55:41.499739 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m13:55:41.499984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:41.512884 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:55:41.514892 [debug] [ThreadPool]: On list_dev: Close
[0m13:55:41.516440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:55:41.516855 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:55:41.519406 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:55:41.519649 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:55:41.519851 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:41.522171 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:55:41.522404 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:55:41.522634 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "connection_name": "create_dev_main"} */
create schema if not exists "dev"."main"
[0m13:55:41.523238 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:55:41.523765 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:55:41.523987 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:55:41.524191 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:55:41.524427 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:55:41.524630 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:55:41.526191 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:55:41.529129 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:55:41.529374 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:55:41.529589 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:41.531760 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:55:41.531989 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:55:41.532211 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m13:55:41.543727 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:55:41.546884 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:55:41.548049 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:55:41.548320 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:55:41.550053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46a1df13-fad8-47af-90c4-a6f8d9f08ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10749f400>]}
[0m13:55:41.550383 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:41.550612 [debug] [MainThread]: On master: BEGIN
[0m13:55:41.550827 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:41.553151 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:55:41.553391 [debug] [MainThread]: On master: COMMIT
[0m13:55:41.553622 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:41.553855 [debug] [MainThread]: On master: COMMIT
[0m13:55:41.554101 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:55:41.554330 [debug] [MainThread]: On master: Close
[0m13:55:41.555425 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:55:41.555685 [info ] [MainThread]: 
[0m13:55:41.556971 [debug] [Thread-1 (]: Began running node model.duckdb_sample_project.my_first_dbt_model
[0m13:55:41.557302 [info ] [Thread-1 (]: 1 of 2 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m13:55:41.557715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.duckdb_sample_project.my_first_dbt_model)
[0m13:55:41.557968 [debug] [Thread-1 (]: Began compiling node model.duckdb_sample_project.my_first_dbt_model
[0m13:55:41.562510 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_sample_project.my_first_dbt_model"
[0m13:55:41.562998 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_first_dbt_model (compile): 13:55:41.558128 => 13:55:41.562842
[0m13:55:41.563259 [debug] [Thread-1 (]: Began executing node model.duckdb_sample_project.my_first_dbt_model
[0m13:55:41.584326 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_sample_project.my_first_dbt_model"
[0m13:55:41.584954 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m13:55:41.585245 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: BEGIN
[0m13:55:41.585504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:41.588151 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:55:41.588419 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m13:55:41.588691 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m13:55:41.590990 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:55:41.594885 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m13:55:41.595207 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m13:55:41.595667 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:55:41.597595 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m13:55:41.597918 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:55:41.598248 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:55:41.609755 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: COMMIT
[0m13:55:41.610116 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m13:55:41.610381 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: COMMIT
[0m13:55:41.610959 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:55:41.614315 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m13:55:41.614682 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m13:55:41.615377 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:55:41.616446 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_first_dbt_model (execute): 13:55:41.563418 => 13:55:41.616297
[0m13:55:41.616746 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: Close
[0m13:55:41.619404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a1df13-fad8-47af-90c4-a6f8d9f08ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10753d180>]}
[0m13:55:41.619909 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m13:55:41.620337 [debug] [Thread-1 (]: Finished running node model.duckdb_sample_project.my_first_dbt_model
[0m13:55:41.620961 [debug] [Thread-1 (]: Began running node model.duckdb_sample_project.my_second_dbt_model
[0m13:55:41.621406 [info ] [Thread-1 (]: 2 of 2 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m13:55:41.621919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.duckdb_sample_project.my_first_dbt_model, now model.duckdb_sample_project.my_second_dbt_model)
[0m13:55:41.622197 [debug] [Thread-1 (]: Began compiling node model.duckdb_sample_project.my_second_dbt_model
[0m13:55:41.624168 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_sample_project.my_second_dbt_model"
[0m13:55:41.624712 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_second_dbt_model (compile): 13:55:41.622365 => 13:55:41.624570
[0m13:55:41.624987 [debug] [Thread-1 (]: Began executing node model.duckdb_sample_project.my_second_dbt_model
[0m13:55:41.636854 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_sample_project.my_second_dbt_model"
[0m13:55:41.637400 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m13:55:41.637662 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: BEGIN
[0m13:55:41.637902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:41.640570 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:55:41.640840 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m13:55:41.641102 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m13:55:41.641475 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:55:41.643509 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m13:55:41.643783 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m13:55:41.644110 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:55:41.645859 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m13:55:41.646116 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:55:41.646410 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:55:41.647644 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: COMMIT
[0m13:55:41.647904 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m13:55:41.648147 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: COMMIT
[0m13:55:41.648660 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:55:41.650557 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m13:55:41.650860 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "model.duckdb_sample_project.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m13:55:41.651335 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:55:41.652288 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_second_dbt_model (execute): 13:55:41.625143 => 13:55:41.652143
[0m13:55:41.652575 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: Close
[0m13:55:41.654044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46a1df13-fad8-47af-90c4-a6f8d9f08ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10726fa60>]}
[0m13:55:41.654584 [info ] [Thread-1 (]: 2 of 2 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.03s]
[0m13:55:41.655051 [debug] [Thread-1 (]: Finished running node model.duckdb_sample_project.my_second_dbt_model
[0m13:55:41.655914 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:41.656196 [debug] [MainThread]: On master: BEGIN
[0m13:55:41.656434 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:55:41.658913 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:55:41.659155 [debug] [MainThread]: On master: COMMIT
[0m13:55:41.659370 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:41.659574 [debug] [MainThread]: On master: COMMIT
[0m13:55:41.659795 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:55:41.660015 [debug] [MainThread]: On master: Close
[0m13:55:41.661029 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:41.661282 [debug] [MainThread]: Connection 'model.duckdb_sample_project.my_second_dbt_model' was properly closed.
[0m13:55:41.661588 [info ] [MainThread]: 
[0m13:55:41.661879 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m13:55:41.662494 [debug] [MainThread]: Command end result
[0m13:55:41.666825 [info ] [MainThread]: 
[0m13:55:41.667108 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:41.667352 [info ] [MainThread]: 
[0m13:55:41.667609 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:55:41.669237 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5109622, "process_user_time": 1.566466, "process_kernel_time": 0.174842, "process_mem_max_rss": "148766720", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:55:41.669667 [debug] [MainThread]: Command `cli run` succeeded at 13:55:41.669577 after 0.51 seconds
[0m13:55:41.669941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10421d870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074ff100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10759c2b0>]}
[0m13:55:41.670212 [debug] [MainThread]: Flushing usage events
[0m14:43:54.563376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105da9660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107523700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107523340>]}


============================== 14:43:54.566983 | 7aa14c96-e801-44f4-a1bf-250d4d6f39ef ==============================
[0m14:43:54.566983 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:43:54.567365 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'send_anonymous_usage_stats': 'True'}
[0m14:43:54.762825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7aa14c96-e801-44f4-a1bf-250d4d6f39ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10745b250>]}
[0m14:43:54.810495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7aa14c96-e801-44f4-a1bf-250d4d6f39ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a2890>]}
[0m14:43:54.811185 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m14:43:54.820511 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m14:43:54.851430 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:43:54.851752 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:43:54.855254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7aa14c96-e801-44f4-a1bf-250d4d6f39ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10796e2c0>]}
[0m14:43:54.855840 [info ] [MainThread]: Performance info: /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/target/perf_info.json
[0m14:43:54.862803 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 0.33561996, "process_user_time": 1.407721, "process_kernel_time": 0.131494, "process_mem_max_rss": "136052736", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:43:54.863228 [debug] [MainThread]: Command `cli parse` succeeded at 14:43:54.863131 after 0.34 seconds
[0m14:43:54.863517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105da9660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079452d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107945420>]}
[0m14:43:54.863769 [debug] [MainThread]: Flushing usage events
[0m14:43:55.316331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c24a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c0520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c3340>]}


============================== 14:43:55.316867 | d7b9f653-ecd1-43b8-a94f-85a52436d9ea ==============================
[0m14:43:55.316867 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:43:55.317368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'send_anonymous_usage_stats': 'True'}
[0m14:43:55.332723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7b9f653-ecd1-43b8-a94f-85a52436d9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107523c70>]}
[0m14:43:55.333913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7b9f653-ecd1-43b8-a94f-85a52436d9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c36a0>]}
[0m14:43:55.334342 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m14:43:55.337588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7b9f653-ecd1-43b8-a94f-85a52436d9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077257b0>]}
[0m14:43:55.337951 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m14:43:55.338267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7b9f653-ecd1-43b8-a94f-85a52436d9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a2380>]}
[0m14:43:55.339385 [info ] [MainThread]: 
[0m14:43:55.339741 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:43:55.340347 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:43:55.344189 [debug] [ThreadPool]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m14:43:55.598987 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:43:55.599325 [debug] [ThreadPool]: On list_dev: 
    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m14:43:55.599559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:55.609103 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:43:55.610564 [debug] [ThreadPool]: On list_dev: Close
[0m14:43:55.611760 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m14:43:55.612058 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m14:43:55.614509 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:43:55.614745 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m14:43:55.614953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:55.617124 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:43:55.617371 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:43:55.617592 [debug] [ThreadPool]: On create_dev_main: create schema if not exists "dev"."main"
[0m14:43:55.617891 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:43:55.618393 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:43:55.618610 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:43:55.618814 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:43:55.619054 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:43:55.619270 [debug] [ThreadPool]: On create_dev_main: Close
[0m14:43:55.620478 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m14:43:55.623556 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:43:55.623787 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:43:55.623994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:55.626256 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:43:55.626489 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:43:55.626707 [debug] [ThreadPool]: On list_dev_main: select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m14:43:55.637028 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:43:55.640147 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:43:55.641306 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:43:55.641527 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:43:55.642921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7b9f653-ecd1-43b8-a94f-85a52436d9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10767a5f0>]}
[0m14:43:55.643235 [debug] [MainThread]: Using duckdb connection "master"
[0m14:43:55.643443 [debug] [MainThread]: On master: BEGIN
[0m14:43:55.643643 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:43:55.645914 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:43:55.646140 [debug] [MainThread]: On master: COMMIT
[0m14:43:55.646351 [debug] [MainThread]: Using duckdb connection "master"
[0m14:43:55.646558 [debug] [MainThread]: On master: COMMIT
[0m14:43:55.646792 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:43:55.647014 [debug] [MainThread]: On master: Close
[0m14:43:55.647794 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:43:55.648052 [info ] [MainThread]: 
[0m14:43:55.649289 [debug] [Thread-1 (]: Began running node model.duckdb_sample_project.my_first_dbt_model
[0m14:43:55.649737 [info ] [Thread-1 (]: 1 of 2 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m14:43:55.650008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.duckdb_sample_project.my_first_dbt_model)
[0m14:43:55.650268 [debug] [Thread-1 (]: Began compiling node model.duckdb_sample_project.my_first_dbt_model
[0m14:43:55.655213 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_sample_project.my_first_dbt_model"
[0m14:43:55.655951 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_first_dbt_model (compile): 14:43:55.650428 => 14:43:55.655799
[0m14:43:55.656226 [debug] [Thread-1 (]: Began executing node model.duckdb_sample_project.my_first_dbt_model
[0m14:43:55.675060 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_sample_project.my_first_dbt_model"
[0m14:43:55.675570 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:43:55.675829 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: BEGIN
[0m14:43:55.676065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:55.678540 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:43:55.678808 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:43:55.679073 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: 
  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m14:43:55.680112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:43:55.683526 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:43:55.683787 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:43:55.684124 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:43:55.685907 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:43:55.686163 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:43:55.686465 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:43:55.697605 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: COMMIT
[0m14:43:55.697907 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:43:55.698165 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: COMMIT
[0m14:43:55.698854 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:43:55.701655 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:43:55.701919 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m14:43:55.702327 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:43:55.703200 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_first_dbt_model (execute): 14:43:55.656389 => 14:43:55.703062
[0m14:43:55.703460 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: Close
[0m14:43:55.705085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b9f653-ecd1-43b8-a94f-85a52436d9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a9e050>]}
[0m14:43:55.705465 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m14:43:55.705846 [debug] [Thread-1 (]: Finished running node model.duckdb_sample_project.my_first_dbt_model
[0m14:43:55.706309 [debug] [Thread-1 (]: Began running node model.duckdb_sample_project.my_second_dbt_model
[0m14:43:55.706657 [info ] [Thread-1 (]: 2 of 2 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m14:43:55.706912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.duckdb_sample_project.my_first_dbt_model, now model.duckdb_sample_project.my_second_dbt_model)
[0m14:43:55.707172 [debug] [Thread-1 (]: Began compiling node model.duckdb_sample_project.my_second_dbt_model
[0m14:43:55.708813 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_sample_project.my_second_dbt_model"
[0m14:43:55.709263 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_second_dbt_model (compile): 14:43:55.707333 => 14:43:55.709126
[0m14:43:55.709522 [debug] [Thread-1 (]: Began executing node model.duckdb_sample_project.my_second_dbt_model
[0m14:43:55.720628 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_sample_project.my_second_dbt_model"
[0m14:43:55.721136 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:43:55.721401 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: BEGIN
[0m14:43:55.721645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:55.724154 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:43:55.724432 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:43:55.724679 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: 
  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m14:43:55.725024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:43:55.726965 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:43:55.727231 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m14:43:55.727556 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:43:55.729329 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:43:55.729574 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:43:55.729861 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:43:55.731049 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: COMMIT
[0m14:43:55.731298 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:43:55.731536 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: COMMIT
[0m14:43:55.731893 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:43:55.733339 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:43:55.733601 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m14:43:55.733924 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:43:55.734717 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_second_dbt_model (execute): 14:43:55.709682 => 14:43:55.734580
[0m14:43:55.734985 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: Close
[0m14:43:55.736204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b9f653-ecd1-43b8-a94f-85a52436d9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a54490>]}
[0m14:43:55.736590 [info ] [Thread-1 (]: 2 of 2 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.03s]
[0m14:43:55.736963 [debug] [Thread-1 (]: Finished running node model.duckdb_sample_project.my_second_dbt_model
[0m14:43:55.737535 [debug] [MainThread]: Using duckdb connection "master"
[0m14:43:55.737798 [debug] [MainThread]: On master: BEGIN
[0m14:43:55.738021 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:43:55.740323 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:43:55.740573 [debug] [MainThread]: On master: COMMIT
[0m14:43:55.740804 [debug] [MainThread]: Using duckdb connection "master"
[0m14:43:55.741030 [debug] [MainThread]: On master: COMMIT
[0m14:43:55.741274 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:43:55.741497 [debug] [MainThread]: On master: Close
[0m14:43:55.742419 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:55.742742 [debug] [MainThread]: Connection 'model.duckdb_sample_project.my_second_dbt_model' was properly closed.
[0m14:43:55.743002 [info ] [MainThread]: 
[0m14:43:55.743259 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m14:43:55.743734 [debug] [MainThread]: Command end result
[0m14:43:55.748878 [info ] [MainThread]: 
[0m14:43:55.749234 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:43:55.749490 [info ] [MainThread]: 
[0m14:43:55.749760 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:43:55.750132 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.43527874, "process_user_time": 1.830072, "process_kernel_time": 0.15916, "process_mem_max_rss": "151846912", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:43:55.750563 [debug] [MainThread]: Command `cli run` succeeded at 14:43:55.750465 after 0.44 seconds
[0m14:43:55.750840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b43010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c36a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10745a590>]}
[0m14:43:55.751117 [debug] [MainThread]: Flushing usage events
[0m14:46:52.225806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ad870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a37700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a37340>]}


============================== 14:46:52.228949 | d98ff713-df1e-40ac-8237-7464463e5942 ==============================
[0m14:46:52.228949 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:46:52.229335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:46:52.434419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd98ff713-df1e-40ac-8237-7464463e5942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10996f250>]}
[0m14:46:52.483652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd98ff713-df1e-40ac-8237-7464463e5942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cb6890>]}
[0m14:46:52.485528 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m14:46:52.496274 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m14:46:52.525779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:46:52.526139 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:46:52.529676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd98ff713-df1e-40ac-8237-7464463e5942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e822c0>]}
[0m14:46:52.530282 [info ] [MainThread]: Performance info: /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/target/perf_info.json
[0m14:46:52.537632 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 0.34635383, "process_user_time": 1.427724, "process_kernel_time": 0.143318, "process_mem_max_rss": "135249920", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:46:52.538086 [debug] [MainThread]: Command `cli parse` succeeded at 14:46:52.537985 after 0.35 seconds
[0m14:46:52.538400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ad870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e592d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e59420>]}
[0m14:46:52.538663 [debug] [MainThread]: Flushing usage events
[0m14:46:52.984793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099d9210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099d9720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099db340>]}


============================== 14:46:52.985461 | e5fe5cc1-1729-4f55-9c05-25790d71499c ==============================
[0m14:46:52.985461 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:46:52.986103 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:46:53.004354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5fe5cc1-1729-4f55-9c05-25790d71499c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a37c70>]}
[0m14:46:53.005593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5fe5cc1-1729-4f55-9c05-25790d71499c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099db6a0>]}
[0m14:46:53.006043 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m14:46:53.007713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5fe5cc1-1729-4f55-9c05-25790d71499c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c497b0>]}
[0m14:46:53.008156 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m14:46:53.008559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5fe5cc1-1729-4f55-9c05-25790d71499c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cb6380>]}
[0m14:46:53.009800 [info ] [MainThread]: 
[0m14:46:53.010218 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:46:53.010902 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:46:53.015129 [debug] [ThreadPool]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m14:46:53.273210 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:46:53.273556 [debug] [ThreadPool]: On list_dev: 
    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m14:46:53.273785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:53.289429 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:46:53.291634 [debug] [ThreadPool]: On list_dev: Close
[0m14:46:53.292859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m14:46:53.293121 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m14:46:53.295617 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:46:53.295846 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m14:46:53.296047 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:46:53.298254 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:46:53.298474 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:46:53.298676 [debug] [ThreadPool]: On create_dev_main: create schema if not exists "dev"."main"
[0m14:46:53.299278 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:46:53.299769 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:46:53.299991 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:46:53.300199 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:46:53.300434 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:46:53.300641 [debug] [ThreadPool]: On create_dev_main: Close
[0m14:46:53.301721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m14:46:53.304648 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:46:53.304882 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:46:53.305087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:46:53.307219 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:46:53.307456 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:46:53.307672 [debug] [ThreadPool]: On list_dev_main: select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m14:46:53.319570 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:46:53.322909 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:46:53.323925 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:46:53.324141 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:46:53.325581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5fe5cc1-1729-4f55-9c05-25790d71499c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b8a5f0>]}
[0m14:46:53.325873 [debug] [MainThread]: Using duckdb connection "master"
[0m14:46:53.326077 [debug] [MainThread]: On master: BEGIN
[0m14:46:53.326273 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:46:53.328394 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:46:53.328621 [debug] [MainThread]: On master: COMMIT
[0m14:46:53.328831 [debug] [MainThread]: Using duckdb connection "master"
[0m14:46:53.329036 [debug] [MainThread]: On master: COMMIT
[0m14:46:53.329263 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:46:53.329472 [debug] [MainThread]: On master: Close
[0m14:46:53.330302 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:46:53.330588 [info ] [MainThread]: 
[0m14:46:53.331805 [debug] [Thread-1 (]: Began running node model.duckdb_sample_project.my_first_dbt_model
[0m14:46:53.332204 [info ] [Thread-1 (]: 1 of 2 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m14:46:53.332455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.duckdb_sample_project.my_first_dbt_model)
[0m14:46:53.332704 [debug] [Thread-1 (]: Began compiling node model.duckdb_sample_project.my_first_dbt_model
[0m14:46:53.337420 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_sample_project.my_first_dbt_model"
[0m14:46:53.337921 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_first_dbt_model (compile): 14:46:53.332855 => 14:46:53.337776
[0m14:46:53.338195 [debug] [Thread-1 (]: Began executing node model.duckdb_sample_project.my_first_dbt_model
[0m14:46:53.357032 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_sample_project.my_first_dbt_model"
[0m14:46:53.357619 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:46:53.357912 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: BEGIN
[0m14:46:53.358170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:53.360883 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:46:53.361144 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:46:53.361400 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: 
  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m14:46:53.363962 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:46:53.367396 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:46:53.367654 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:46:53.368179 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:46:53.369946 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:46:53.370203 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:46:53.370511 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:46:53.381642 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: COMMIT
[0m14:46:53.381908 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:46:53.382152 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: COMMIT
[0m14:46:53.382999 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:46:53.385821 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:46:53.386074 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m14:46:53.386589 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:46:53.387361 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_first_dbt_model (execute): 14:46:53.338354 => 14:46:53.387233
[0m14:46:53.387644 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: Close
[0m14:46:53.390215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5fe5cc1-1729-4f55-9c05-25790d71499c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fb2050>]}
[0m14:46:53.390615 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m14:46:53.390991 [debug] [Thread-1 (]: Finished running node model.duckdb_sample_project.my_first_dbt_model
[0m14:46:53.391450 [debug] [Thread-1 (]: Began running node model.duckdb_sample_project.my_second_dbt_model
[0m14:46:53.391767 [info ] [Thread-1 (]: 2 of 2 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m14:46:53.392030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.duckdb_sample_project.my_first_dbt_model, now model.duckdb_sample_project.my_second_dbt_model)
[0m14:46:53.392279 [debug] [Thread-1 (]: Began compiling node model.duckdb_sample_project.my_second_dbt_model
[0m14:46:53.393814 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_sample_project.my_second_dbt_model"
[0m14:46:53.394251 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_second_dbt_model (compile): 14:46:53.392428 => 14:46:53.394121
[0m14:46:53.394494 [debug] [Thread-1 (]: Began executing node model.duckdb_sample_project.my_second_dbt_model
[0m14:46:53.405490 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_sample_project.my_second_dbt_model"
[0m14:46:53.405992 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:46:53.406251 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: BEGIN
[0m14:46:53.406487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:53.409065 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:46:53.409333 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:46:53.409580 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: 
  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m14:46:53.409905 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:46:53.411845 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:46:53.412127 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m14:46:53.412475 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:46:53.414260 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:46:53.414513 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:46:53.414810 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:46:53.415984 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: COMMIT
[0m14:46:53.416236 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:46:53.416464 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: COMMIT
[0m14:46:53.416827 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:46:53.418287 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:46:53.418547 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m14:46:53.418884 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:46:53.419652 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_second_dbt_model (execute): 14:46:53.394646 => 14:46:53.419523
[0m14:46:53.419899 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: Close
[0m14:46:53.421144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5fe5cc1-1729-4f55-9c05-25790d71499c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f68490>]}
[0m14:46:53.421525 [info ] [Thread-1 (]: 2 of 2 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.03s]
[0m14:46:53.421895 [debug] [Thread-1 (]: Finished running node model.duckdb_sample_project.my_second_dbt_model
[0m14:46:53.422455 [debug] [MainThread]: Using duckdb connection "master"
[0m14:46:53.422692 [debug] [MainThread]: On master: BEGIN
[0m14:46:53.422890 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:46:53.425120 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:46:53.425353 [debug] [MainThread]: On master: COMMIT
[0m14:46:53.425574 [debug] [MainThread]: Using duckdb connection "master"
[0m14:46:53.425789 [debug] [MainThread]: On master: COMMIT
[0m14:46:53.426019 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:46:53.426229 [debug] [MainThread]: On master: Close
[0m14:46:53.427108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:46:53.427426 [debug] [MainThread]: Connection 'model.duckdb_sample_project.my_second_dbt_model' was properly closed.
[0m14:46:53.427689 [info ] [MainThread]: 
[0m14:46:53.427940 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m14:46:53.428414 [debug] [MainThread]: Command end result
[0m14:46:53.433471 [info ] [MainThread]: 
[0m14:46:53.433804 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:46:53.434051 [info ] [MainThread]: 
[0m14:46:53.434308 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:46:53.434628 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4517428, "process_user_time": 1.853711, "process_kernel_time": 0.172546, "process_mem_max_rss": "151601152", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:46:53.434945 [debug] [MainThread]: Command `cli run` succeeded at 14:46:53.434860 after 0.45 seconds
[0m14:46:53.435194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fe7a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099db6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10996e590>]}
[0m14:46:53.435470 [debug] [MainThread]: Flushing usage events
[0m14:50:46.607337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086258a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dafee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dafb20>]}


============================== 14:50:46.610227 | 78616b23-fb2f-4519-b478-4beb0e4b97f8 ==============================
[0m14:50:46.610227 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:50:46.610610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'send_anonymous_usage_stats': 'True'}
[0m14:50:46.756748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78616b23-fb2f-4519-b478-4beb0e4b97f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e2a770>]}
[0m14:50:46.807331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78616b23-fb2f-4519-b478-4beb0e4b97f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a02b3d0>]}
[0m14:50:46.808262 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m14:50:46.817307 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m14:50:46.836600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:50:46.836913 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:50:46.840384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78616b23-fb2f-4519-b478-4beb0e4b97f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1fa320>]}
[0m14:50:46.840958 [info ] [MainThread]: Performance info: /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/target/perf_info.json
[0m14:50:46.847575 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 0.2749167, "process_user_time": 1.409151, "process_kernel_time": 0.136926, "process_mem_max_rss": "132988928", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:50:46.847981 [debug] [MainThread]: Command `cli parse` succeeded at 14:50:46.847883 after 0.28 seconds
[0m14:50:46.848262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086258a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1d13f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1d1480>]}
[0m14:50:46.848516 [debug] [MainThread]: Flushing usage events
[0m14:50:47.254412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108170280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109daf160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109daef80>]}


============================== 14:50:47.254934 | ca02343a-db51-4831-88ce-5fd9b591f151 ==============================
[0m14:50:47.254934 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:50:47.255375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'send_anonymous_usage_stats': 'True'}
[0m14:50:47.274058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca02343a-db51-4831-88ce-5fd9b591f151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a058a0>]}
[0m14:50:47.275229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca02343a-db51-4831-88ce-5fd9b591f151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109daf0a0>]}
[0m14:50:47.275609 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m14:50:47.277045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca02343a-db51-4831-88ce-5fd9b591f151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109daf130>]}
[0m14:50:47.277337 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m14:50:47.277588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca02343a-db51-4831-88ce-5fd9b591f151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109daf0d0>]}
[0m14:50:47.278625 [info ] [MainThread]: 
[0m14:50:47.278934 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:50:47.279622 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:50:47.285686 [debug] [ThreadPool]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m14:50:47.541851 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:50:47.542224 [debug] [ThreadPool]: On list_dev: 
    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m14:50:47.542467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:47.546041 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:50:47.546968 [debug] [ThreadPool]: On list_dev: Close
[0m14:50:47.548005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m14:50:47.548332 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m14:50:47.551121 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:50:47.551432 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m14:50:47.551671 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:47.554081 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:50:47.554336 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:50:47.554569 [debug] [ThreadPool]: On create_dev_main: create schema if not exists "dev"."main"
[0m14:50:47.554837 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:50:47.555367 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:50:47.555591 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:50:47.555800 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:50:47.556042 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:50:47.556261 [debug] [ThreadPool]: On create_dev_main: Close
[0m14:50:47.557446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m14:50:47.560876 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:50:47.561148 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:50:47.561374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:47.563836 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:50:47.564086 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:50:47.564345 [debug] [ThreadPool]: On list_dev_main: select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m14:50:47.574211 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:50:47.576759 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:50:47.578039 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:50:47.578360 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:50:47.580166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca02343a-db51-4831-88ce-5fd9b591f151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c83fc70>]}
[0m14:50:47.580571 [debug] [MainThread]: Using duckdb connection "master"
[0m14:50:47.580835 [debug] [MainThread]: On master: BEGIN
[0m14:50:47.581070 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:47.583780 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:50:47.584059 [debug] [MainThread]: On master: COMMIT
[0m14:50:47.584297 [debug] [MainThread]: Using duckdb connection "master"
[0m14:50:47.584526 [debug] [MainThread]: On master: COMMIT
[0m14:50:47.584775 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:50:47.585010 [debug] [MainThread]: On master: Close
[0m14:50:47.585902 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:50:47.586194 [info ] [MainThread]: 
[0m14:50:47.587590 [debug] [Thread-1 (]: Began running node model.duckdb_sample_project.my_first_dbt_model
[0m14:50:47.588054 [info ] [Thread-1 (]: 1 of 2 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m14:50:47.588330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.duckdb_sample_project.my_first_dbt_model)
[0m14:50:47.588595 [debug] [Thread-1 (]: Began compiling node model.duckdb_sample_project.my_first_dbt_model
[0m14:50:47.594079 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_sample_project.my_first_dbt_model"
[0m14:50:47.594654 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_first_dbt_model (compile): 14:50:47.588765 => 14:50:47.594502
[0m14:50:47.594927 [debug] [Thread-1 (]: Began executing node model.duckdb_sample_project.my_first_dbt_model
[0m14:50:47.615628 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_sample_project.my_first_dbt_model"
[0m14:50:47.616275 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:50:47.616561 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: BEGIN
[0m14:50:47.616821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:47.619712 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:47.620085 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:50:47.620392 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: 
  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m14:50:47.620928 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:47.625071 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:50:47.625737 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:50:47.626997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:47.629175 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:50:47.629467 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:50:47.629806 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:47.642244 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: COMMIT
[0m14:50:47.642594 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:50:47.642868 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: COMMIT
[0m14:50:47.643498 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:47.646731 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:50:47.647013 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m14:50:47.647520 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:47.648871 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_first_dbt_model (execute): 14:50:47.595101 => 14:50:47.648704
[0m14:50:47.649202 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: Close
[0m14:50:47.650914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca02343a-db51-4831-88ce-5fd9b591f151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1bf6a0>]}
[0m14:50:47.651375 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m14:50:47.651770 [debug] [Thread-1 (]: Finished running node model.duckdb_sample_project.my_first_dbt_model
[0m14:50:47.652368 [debug] [Thread-1 (]: Began running node model.duckdb_sample_project.my_second_dbt_model
[0m14:50:47.652749 [info ] [Thread-1 (]: 2 of 2 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m14:50:47.653024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.duckdb_sample_project.my_first_dbt_model, now model.duckdb_sample_project.my_second_dbt_model)
[0m14:50:47.653293 [debug] [Thread-1 (]: Began compiling node model.duckdb_sample_project.my_second_dbt_model
[0m14:50:47.655212 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_sample_project.my_second_dbt_model"
[0m14:50:47.655830 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_second_dbt_model (compile): 14:50:47.653461 => 14:50:47.655679
[0m14:50:47.656118 [debug] [Thread-1 (]: Began executing node model.duckdb_sample_project.my_second_dbt_model
[0m14:50:47.669195 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_sample_project.my_second_dbt_model"
[0m14:50:47.669822 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:50:47.670100 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: BEGIN
[0m14:50:47.670358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:47.672994 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:47.673292 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:50:47.673704 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: 
  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m14:50:47.674144 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:47.676244 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:50:47.676531 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m14:50:47.676867 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:47.678801 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:50:47.679122 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:50:47.679483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:47.681125 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: COMMIT
[0m14:50:47.681463 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:50:47.681743 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: COMMIT
[0m14:50:47.682218 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:47.684018 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:50:47.684304 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m14:50:47.684746 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:50:47.685873 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_second_dbt_model (execute): 14:50:47.656291 => 14:50:47.685717
[0m14:50:47.686183 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: Close
[0m14:50:47.687577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca02343a-db51-4831-88ce-5fd9b591f151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2e04f0>]}
[0m14:50:47.688006 [info ] [Thread-1 (]: 2 of 2 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.03s]
[0m14:50:47.688390 [debug] [Thread-1 (]: Finished running node model.duckdb_sample_project.my_second_dbt_model
[0m14:50:47.689085 [debug] [MainThread]: Using duckdb connection "master"
[0m14:50:47.689385 [debug] [MainThread]: On master: BEGIN
[0m14:50:47.689625 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:47.692388 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:50:47.692676 [debug] [MainThread]: On master: COMMIT
[0m14:50:47.692916 [debug] [MainThread]: Using duckdb connection "master"
[0m14:50:47.693145 [debug] [MainThread]: On master: COMMIT
[0m14:50:47.693397 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:50:47.693628 [debug] [MainThread]: On master: Close
[0m14:50:47.694598 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:47.694941 [debug] [MainThread]: Connection 'model.duckdb_sample_project.my_second_dbt_model' was properly closed.
[0m14:50:47.695232 [info ] [MainThread]: 
[0m14:50:47.695514 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m14:50:47.696023 [debug] [MainThread]: Command end result
[0m14:50:47.701012 [info ] [MainThread]: 
[0m14:50:47.701339 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:50:47.701589 [info ] [MainThread]: 
[0m14:50:47.701850 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:50:47.702186 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.44957572, "process_user_time": 1.843547, "process_kernel_time": 0.164074, "process_mem_max_rss": "153485312", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:50:47.702520 [debug] [MainThread]: Command `cli run` succeeded at 14:50:47.702434 after 0.45 seconds
[0m14:50:47.702798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108170280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c84a290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c84ada0>]}
[0m14:50:47.703086 [debug] [MainThread]: Flushing usage events
[0m14:50:48.037487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108627ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2e0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2e0610>]}


============================== 14:50:48.037865 | 2c5f3cef-71de-425b-956c-e70f31b55d06 ==============================
[0m14:50:48.037865 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:50:48.038201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'send_anonymous_usage_stats': 'True'}
[0m14:50:48.050757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c5f3cef-71de-425b-956c-e70f31b55d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fbc190>]}
[0m14:50:48.051731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c5f3cef-71de-425b-956c-e70f31b55d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c80a1d0>]}
[0m14:50:48.052065 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m14:50:48.055399 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m14:50:48.073868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:50:48.074154 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:50:48.077220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c5f3cef-71de-425b-956c-e70f31b55d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11607c0d0>]}
[0m14:50:48.082674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c5f3cef-71de-425b-956c-e70f31b55d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3420b0>]}
[0m14:50:48.083014 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m14:50:48.083270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c5f3cef-71de-425b-956c-e70f31b55d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a340580>]}
[0m14:50:48.083862 [info ] [MainThread]: 
[0m14:50:48.084304 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:50:48.084988 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m14:50:48.086520 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:50:48.086795 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:50:48.087025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:48.089565 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:50:48.089817 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:50:48.090060 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m14:50:48.100343 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:50:48.103177 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:50:48.103867 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:50:48.104090 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:50:48.106026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c5f3cef-71de-425b-956c-e70f31b55d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a341d20>]}
[0m14:50:48.106423 [debug] [MainThread]: Using duckdb connection "master"
[0m14:50:48.106674 [debug] [MainThread]: On master: BEGIN
[0m14:50:48.106907 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:48.109514 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:50:48.109798 [debug] [MainThread]: On master: COMMIT
[0m14:50:48.110024 [debug] [MainThread]: Using duckdb connection "master"
[0m14:50:48.110232 [debug] [MainThread]: On master: COMMIT
[0m14:50:48.110470 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:50:48.110688 [debug] [MainThread]: On master: Close
[0m14:50:48.111682 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:50:48.111958 [info ] [MainThread]: 
[0m14:50:48.112679 [debug] [Thread-5 (]: Began running node test.duckdb_sample_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:50:48.112966 [info ] [Thread-5 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m14:50:48.113398 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly list_dev_main, now test.duckdb_sample_project.not_null_my_first_dbt_model_id.5fb22c2710)
[0m14:50:48.113664 [debug] [Thread-5 (]: Began compiling node test.duckdb_sample_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:50:48.120990 [debug] [Thread-5 (]: Writing injected SQL for node "test.duckdb_sample_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:50:48.121690 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 14:50:48.113826 => 14:50:48.121542
[0m14:50:48.121976 [debug] [Thread-5 (]: Began executing node test.duckdb_sample_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:50:48.130525 [debug] [Thread-5 (]: Writing runtime sql for node "test.duckdb_sample_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:50:48.131128 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:50:48.131384 [debug] [Thread-5 (]: On test.duckdb_sample_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m14:50:48.131741 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m14:50:48.134492 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m14:50:48.134797 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:50:48.135093 [debug] [Thread-5 (]: On test.duckdb_sample_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "test.duckdb_sample_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."main"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m14:50:48.137035 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m14:50:48.138696 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 14:50:48.122139 => 14:50:48.138524
[0m14:50:48.139008 [debug] [Thread-5 (]: On test.duckdb_sample_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m14:50:48.139677 [debug] [Thread-5 (]: Failed to rollback 'test.duckdb_sample_project.not_null_my_first_dbt_model_id.5fb22c2710'
[0m14:50:48.139932 [debug] [Thread-5 (]: On test.duckdb_sample_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m14:50:48.141251 [error] [Thread-5 (]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.03s]
[0m14:50:48.141669 [debug] [Thread-5 (]: Finished running node test.duckdb_sample_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:50:48.142041 [debug] [Thread-5 (]: Began running node test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778
[0m14:50:48.142433 [info ] [Thread-5 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m14:50:48.142899 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.duckdb_sample_project.not_null_my_first_dbt_model_id.5fb22c2710, now test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778)
[0m14:50:48.143169 [debug] [Thread-5 (]: Began compiling node test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778
[0m14:50:48.146039 [debug] [Thread-5 (]: Writing injected SQL for node "test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778"
[0m14:50:48.146569 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778 (compile): 14:50:48.143333 => 14:50:48.146428
[0m14:50:48.146847 [debug] [Thread-5 (]: Began executing node test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778
[0m14:50:48.148324 [debug] [Thread-5 (]: Writing runtime sql for node "test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778"
[0m14:50:48.148814 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778"
[0m14:50:48.149100 [debug] [Thread-5 (]: On test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m14:50:48.149360 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m14:50:48.151848 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m14:50:48.152115 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778"
[0m14:50:48.152381 [debug] [Thread-5 (]: On test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."main"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m14:50:48.153422 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m14:50:48.154299 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778 (execute): 14:50:48.147021 => 14:50:48.154155
[0m14:50:48.154566 [debug] [Thread-5 (]: On test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m14:50:48.155213 [debug] [Thread-5 (]: Failed to rollback 'test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778'
[0m14:50:48.155481 [debug] [Thread-5 (]: On test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778: Close
[0m14:50:48.156841 [info ] [Thread-5 (]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.01s]
[0m14:50:48.157267 [debug] [Thread-5 (]: Finished running node test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778
[0m14:50:48.157555 [debug] [Thread-5 (]: Began running node test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321
[0m14:50:48.157906 [info ] [Thread-5 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m14:50:48.158399 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778, now test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321)
[0m14:50:48.158666 [debug] [Thread-5 (]: Began compiling node test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321
[0m14:50:48.198126 [debug] [Thread-5 (]: Writing injected SQL for node "test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321"
[0m14:50:48.198802 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321 (compile): 14:50:48.158835 => 14:50:48.198630
[0m14:50:48.199101 [debug] [Thread-5 (]: Began executing node test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321
[0m14:50:48.200810 [debug] [Thread-5 (]: Writing runtime sql for node "test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321"
[0m14:50:48.201334 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321"
[0m14:50:48.201721 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m14:50:48.201998 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m14:50:48.204527 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m14:50:48.204827 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321"
[0m14:50:48.205097 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."main"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:50:48.207713 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m14:50:48.208943 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321 (execute): 14:50:48.199275 => 14:50:48.208771
[0m14:50:48.209235 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m14:50:48.209921 [debug] [Thread-5 (]: Failed to rollback 'test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321'
[0m14:50:48.210215 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321: Close
[0m14:50:48.211498 [info ] [Thread-5 (]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.05s]
[0m14:50:48.211931 [debug] [Thread-5 (]: Finished running node test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321
[0m14:50:48.212228 [debug] [Thread-5 (]: Began running node test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493
[0m14:50:48.212596 [info ] [Thread-5 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m14:50:48.213117 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321, now test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493)
[0m14:50:48.213396 [debug] [Thread-5 (]: Began compiling node test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493
[0m14:50:48.215996 [debug] [Thread-5 (]: Writing injected SQL for node "test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:50:48.216504 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493 (compile): 14:50:48.213564 => 14:50:48.216364
[0m14:50:48.216760 [debug] [Thread-5 (]: Began executing node test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493
[0m14:50:48.218370 [debug] [Thread-5 (]: Writing runtime sql for node "test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:50:48.218836 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:50:48.219114 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m14:50:48.219366 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m14:50:48.222063 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m14:50:48.222348 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:50:48.222625 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."main"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:50:48.223450 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m14:50:48.224449 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493 (execute): 14:50:48.216922 => 14:50:48.224295
[0m14:50:48.224742 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m14:50:48.225394 [debug] [Thread-5 (]: Failed to rollback 'test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493'
[0m14:50:48.225647 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m14:50:48.226959 [info ] [Thread-5 (]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.01s]
[0m14:50:48.227416 [debug] [Thread-5 (]: Finished running node test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493
[0m14:50:48.228197 [debug] [MainThread]: Using duckdb connection "master"
[0m14:50:48.228459 [debug] [MainThread]: On master: BEGIN
[0m14:50:48.228682 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:48.231075 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:50:48.231325 [debug] [MainThread]: On master: COMMIT
[0m14:50:48.231552 [debug] [MainThread]: Using duckdb connection "master"
[0m14:50:48.231767 [debug] [MainThread]: On master: COMMIT
[0m14:50:48.232008 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:50:48.232230 [debug] [MainThread]: On master: Close
[0m14:50:48.233350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:48.233602 [debug] [MainThread]: Connection 'test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m14:50:48.233880 [info ] [MainThread]: 
[0m14:50:48.234143 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m14:50:48.234772 [debug] [MainThread]: Command end result
[0m14:50:48.239294 [info ] [MainThread]: 
[0m14:50:48.239693 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:50:48.239992 [info ] [MainThread]: 
[0m14:50:48.240252 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m14:50:48.240504 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:50:48.240748 [info ] [MainThread]: 
[0m14:50:48.240993 [info ] [MainThread]:   compiled Code at target/compiled/duckdb_sample_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m14:50:48.241241 [info ] [MainThread]: 
[0m14:50:48.241484 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m14:50:48.241826 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.20527229, "process_user_time": 2.037622, "process_kernel_time": 0.19006, "process_mem_max_rss": "158515200", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:50:48.242155 [debug] [MainThread]: Command `cli test` failed at 14:50:48.242070 after 0.21 seconds
[0m14:50:48.242432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108627ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c804670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c837e50>]}
[0m14:50:48.242800 [debug] [MainThread]: Flushing usage events
[0m14:53:37.763390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105a3f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105a3b50>]}


============================== 14:53:37.767045 | 7215ca7c-ee79-44c6-b255-f196671af9ed ==============================
[0m14:53:37.767045 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:53:37.767459 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:53:37.974611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7215ca7c-ee79-44c6-b255-f196671af9ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108146d0>]}
[0m14:53:38.023219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7215ca7c-ee79-44c6-b255-f196671af9ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bd8520>]}
[0m14:53:38.024107 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m14:53:38.034670 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m14:53:38.065057 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:53:38.065594 [debug] [MainThread]: Partial parsing: updated file: duckdb_sample_project://models/example/schema.yml
[0m14:53:38.133603 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m14:53:38.229878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7215ca7c-ee79-44c6-b255-f196671af9ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111382950>]}
[0m14:53:38.232861 [info ] [MainThread]: Performance info: /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/target/perf_info.json
[0m14:53:38.249036 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 0.5215069, "process_user_time": 1.623001, "process_kernel_time": 0.165402, "process_mem_max_rss": "143294464", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:53:38.252530 [debug] [MainThread]: Command `cli parse` succeeded at 14:53:38.252399 after 0.53 seconds
[0m14:53:38.252847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108153f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f814e0>]}
[0m14:53:38.253436 [debug] [MainThread]: Flushing usage events
[0m14:53:38.691955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef4280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105a3190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105a2fb0>]}


============================== 14:53:38.692451 | 7f9d51c9-1ade-47b5-b183-1b850bcd82c9 ==============================
[0m14:53:38.692451 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:53:38.692898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:53:38.708474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f9d51c9-1ade-47b5-b183-1b850bcd82c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108151b0>]}
[0m14:53:38.709514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f9d51c9-1ade-47b5-b183-1b850bcd82c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105a30d0>]}
[0m14:53:38.709892 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m14:53:38.711646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f9d51c9-1ade-47b5-b183-1b850bcd82c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b18250>]}
[0m14:53:38.711992 [info ] [MainThread]: Found 2 models, 3 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m14:53:38.712294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f9d51c9-1ade-47b5-b183-1b850bcd82c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b19600>]}
[0m14:53:38.713444 [info ] [MainThread]: 
[0m14:53:38.713782 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:53:38.714370 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:53:38.718316 [debug] [ThreadPool]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m14:53:38.967629 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:53:38.969937 [debug] [ThreadPool]: On list_dev: 
    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m14:53:38.970212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:38.994628 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:53:38.996639 [debug] [ThreadPool]: On list_dev: Close
[0m14:53:38.999940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m14:53:39.003862 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m14:53:39.006768 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:53:39.008911 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m14:53:39.009573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:39.014671 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:53:39.018947 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:53:39.019258 [debug] [ThreadPool]: On create_dev_main: create schema if not exists "dev"."main"
[0m14:53:39.019831 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:53:39.020564 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:53:39.023897 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:53:39.024179 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:53:39.024494 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:53:39.024854 [debug] [ThreadPool]: On create_dev_main: Close
[0m14:53:39.030022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m14:53:39.033721 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:53:39.034020 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:53:39.034240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:39.036753 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:53:39.037012 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:53:39.037239 [debug] [ThreadPool]: On list_dev_main: select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m14:53:39.050563 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:53:39.054040 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:53:39.055253 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:53:39.055532 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:53:39.057147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f9d51c9-1ade-47b5-b183-1b850bcd82c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b1abf0>]}
[0m14:53:39.057475 [debug] [MainThread]: Using duckdb connection "master"
[0m14:53:39.057705 [debug] [MainThread]: On master: BEGIN
[0m14:53:39.057924 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:53:39.060382 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:53:39.060632 [debug] [MainThread]: On master: COMMIT
[0m14:53:39.060854 [debug] [MainThread]: Using duckdb connection "master"
[0m14:53:39.061074 [debug] [MainThread]: On master: COMMIT
[0m14:53:39.061391 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:53:39.061738 [debug] [MainThread]: On master: Close
[0m14:53:39.062668 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:53:39.062967 [info ] [MainThread]: 
[0m14:53:39.064417 [debug] [Thread-1 (]: Began running node model.duckdb_sample_project.my_first_dbt_model
[0m14:53:39.064891 [info ] [Thread-1 (]: 1 of 2 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m14:53:39.065169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.duckdb_sample_project.my_first_dbt_model)
[0m14:53:39.065426 [debug] [Thread-1 (]: Began compiling node model.duckdb_sample_project.my_first_dbt_model
[0m14:53:39.070702 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_sample_project.my_first_dbt_model"
[0m14:53:39.071288 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_first_dbt_model (compile): 14:53:39.065589 => 14:53:39.071140
[0m14:53:39.071558 [debug] [Thread-1 (]: Began executing node model.duckdb_sample_project.my_first_dbt_model
[0m14:53:39.091360 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_sample_project.my_first_dbt_model"
[0m14:53:39.092098 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:53:39.092418 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: BEGIN
[0m14:53:39.092698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:39.095327 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:53:39.095592 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:53:39.095848 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: 
  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m14:53:39.097796 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:53:39.101889 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:53:39.102182 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:53:39.102603 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:53:39.104401 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:53:39.104672 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:53:39.104988 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:53:39.116308 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: COMMIT
[0m14:53:39.116612 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:53:39.116877 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: COMMIT
[0m14:53:39.117433 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:53:39.120508 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:53:39.120805 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m14:53:39.121369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:53:39.122204 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_first_dbt_model (execute): 14:53:39.071721 => 14:53:39.122057
[0m14:53:39.122476 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: Close
[0m14:53:39.124411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f9d51c9-1ade-47b5-b183-1b850bcd82c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f6f5e0>]}
[0m14:53:39.124844 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m14:53:39.125225 [debug] [Thread-1 (]: Finished running node model.duckdb_sample_project.my_first_dbt_model
[0m14:53:39.125724 [debug] [Thread-1 (]: Began running node model.duckdb_sample_project.my_second_dbt_model
[0m14:53:39.126102 [info ] [Thread-1 (]: 2 of 2 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m14:53:39.126367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.duckdb_sample_project.my_first_dbt_model, now model.duckdb_sample_project.my_second_dbt_model)
[0m14:53:39.126616 [debug] [Thread-1 (]: Began compiling node model.duckdb_sample_project.my_second_dbt_model
[0m14:53:39.128239 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_sample_project.my_second_dbt_model"
[0m14:53:39.128680 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_second_dbt_model (compile): 14:53:39.126776 => 14:53:39.128551
[0m14:53:39.128935 [debug] [Thread-1 (]: Began executing node model.duckdb_sample_project.my_second_dbt_model
[0m14:53:39.172816 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_sample_project.my_second_dbt_model"
[0m14:53:39.173437 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:53:39.173705 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: BEGIN
[0m14:53:39.173953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:39.176518 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:53:39.176792 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:53:39.177050 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: 
  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m14:53:39.177410 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:53:39.179371 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:53:39.179626 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m14:53:39.179952 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:53:39.181677 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:53:39.181923 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:53:39.182208 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:53:39.183393 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: COMMIT
[0m14:53:39.183639 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:53:39.183872 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: COMMIT
[0m14:53:39.184240 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:53:39.185694 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:53:39.185947 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m14:53:39.186301 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:53:39.187137 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_second_dbt_model (execute): 14:53:39.129091 => 14:53:39.186996
[0m14:53:39.187400 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: Close
[0m14:53:39.188595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f9d51c9-1ade-47b5-b183-1b850bcd82c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111578520>]}
[0m14:53:39.188968 [info ] [Thread-1 (]: 2 of 2 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m14:53:39.189337 [debug] [Thread-1 (]: Finished running node model.duckdb_sample_project.my_second_dbt_model
[0m14:53:39.189915 [debug] [MainThread]: Using duckdb connection "master"
[0m14:53:39.190131 [debug] [MainThread]: On master: BEGIN
[0m14:53:39.190328 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:53:39.192588 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:53:39.192824 [debug] [MainThread]: On master: COMMIT
[0m14:53:39.193039 [debug] [MainThread]: Using duckdb connection "master"
[0m14:53:39.193256 [debug] [MainThread]: On master: COMMIT
[0m14:53:39.193487 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:53:39.193702 [debug] [MainThread]: On master: Close
[0m14:53:39.194628 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:39.194932 [debug] [MainThread]: Connection 'model.duckdb_sample_project.my_second_dbt_model' was properly closed.
[0m14:53:39.195181 [info ] [MainThread]: 
[0m14:53:39.195432 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m14:53:39.195901 [debug] [MainThread]: Command end result
[0m14:53:39.200197 [info ] [MainThread]: 
[0m14:53:39.200472 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:53:39.200693 [info ] [MainThread]: 
[0m14:53:39.200936 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:53:39.201257 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5107311, "process_user_time": 2.080293, "process_kernel_time": 0.195504, "process_mem_max_rss": "159399936", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:53:39.201569 [debug] [MainThread]: Command `cli run` succeeded at 14:53:39.201487 after 0.51 seconds
[0m14:53:39.201824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef4280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112b1300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111578520>]}
[0m14:53:39.202082 [debug] [MainThread]: Flushing usage events
[0m14:53:39.536784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063bbca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114f93f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114f8e20>]}


============================== 14:53:39.537112 | 56682b89-5770-416f-92ce-4826336b3e77 ==============================
[0m14:53:39.537112 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:53:39.537444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:53:39.549557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56682b89-5770-416f-92ce-4826336b3e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111220ee0>]}
[0m14:53:39.550499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56682b89-5770-416f-92ce-4826336b3e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f53d90>]}
[0m14:53:39.550820 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m14:53:39.553922 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m14:53:39.571202 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:53:39.571547 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:53:39.574994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56682b89-5770-416f-92ce-4826336b3e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111397280>]}
[0m14:53:39.580259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56682b89-5770-416f-92ce-4826336b3e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f8cb20>]}
[0m14:53:39.580556 [info ] [MainThread]: Found 2 models, 3 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m14:53:39.580817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56682b89-5770-416f-92ce-4826336b3e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f8cc10>]}
[0m14:53:39.581442 [info ] [MainThread]: 
[0m14:53:39.581903 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:53:39.582551 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m14:53:39.584020 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:53:39.584343 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:53:39.584563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:39.587026 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:53:39.587258 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:53:39.587488 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m14:53:39.597549 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:53:39.600221 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:53:39.600905 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:53:39.601149 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:53:39.603241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56682b89-5770-416f-92ce-4826336b3e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f8d150>]}
[0m14:53:39.603628 [debug] [MainThread]: Using duckdb connection "master"
[0m14:53:39.603860 [debug] [MainThread]: On master: BEGIN
[0m14:53:39.604080 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:53:39.606467 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:53:39.606706 [debug] [MainThread]: On master: COMMIT
[0m14:53:39.606917 [debug] [MainThread]: Using duckdb connection "master"
[0m14:53:39.607117 [debug] [MainThread]: On master: COMMIT
[0m14:53:39.607343 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:53:39.607550 [debug] [MainThread]: On master: Close
[0m14:53:39.608744 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:53:39.609107 [info ] [MainThread]: 
[0m14:53:39.610059 [debug] [Thread-5 (]: Began running node test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778
[0m14:53:39.610355 [info ] [Thread-5 (]: 1 of 3 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m14:53:39.610789 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly list_dev_main, now test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778)
[0m14:53:39.611036 [debug] [Thread-5 (]: Began compiling node test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778
[0m14:53:39.618107 [debug] [Thread-5 (]: Writing injected SQL for node "test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778"
[0m14:53:39.618644 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778 (compile): 14:53:39.611190 => 14:53:39.618505
[0m14:53:39.618899 [debug] [Thread-5 (]: Began executing node test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778
[0m14:53:39.627278 [debug] [Thread-5 (]: Writing runtime sql for node "test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778"
[0m14:53:39.627853 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778"
[0m14:53:39.628116 [debug] [Thread-5 (]: On test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m14:53:39.628358 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m14:53:39.631029 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m14:53:39.631341 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778"
[0m14:53:39.631605 [debug] [Thread-5 (]: On test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."main"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m14:53:39.633130 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m14:53:39.634398 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778 (execute): 14:53:39.619053 => 14:53:39.634250
[0m14:53:39.634671 [debug] [Thread-5 (]: On test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m14:53:39.635309 [debug] [Thread-5 (]: Failed to rollback 'test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778'
[0m14:53:39.635555 [debug] [Thread-5 (]: On test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778: Close
[0m14:53:39.636853 [info ] [Thread-5 (]: 1 of 3 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.03s]
[0m14:53:39.637297 [debug] [Thread-5 (]: Finished running node test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778
[0m14:53:39.637603 [debug] [Thread-5 (]: Began running node test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321
[0m14:53:39.637960 [info ] [Thread-5 (]: 2 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m14:53:39.638463 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778, now test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321)
[0m14:53:39.638741 [debug] [Thread-5 (]: Began compiling node test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321
[0m14:53:39.642588 [debug] [Thread-5 (]: Writing injected SQL for node "test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321"
[0m14:53:39.643142 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321 (compile): 14:53:39.638904 => 14:53:39.642976
[0m14:53:39.643449 [debug] [Thread-5 (]: Began executing node test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321
[0m14:53:39.644944 [debug] [Thread-5 (]: Writing runtime sql for node "test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321"
[0m14:53:39.645389 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321"
[0m14:53:39.645647 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m14:53:39.645880 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m14:53:39.648372 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m14:53:39.648689 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321"
[0m14:53:39.648944 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."main"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:53:39.651466 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m14:53:39.652423 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321 (execute): 14:53:39.643610 => 14:53:39.652272
[0m14:53:39.652691 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m14:53:39.653293 [debug] [Thread-5 (]: Failed to rollback 'test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321'
[0m14:53:39.653523 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321: Close
[0m14:53:39.654671 [info ] [Thread-5 (]: 2 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.02s]
[0m14:53:39.655086 [debug] [Thread-5 (]: Finished running node test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321
[0m14:53:39.655390 [debug] [Thread-5 (]: Began running node test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493
[0m14:53:39.655771 [info ] [Thread-5 (]: 3 of 3 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m14:53:39.656342 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321, now test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493)
[0m14:53:39.656628 [debug] [Thread-5 (]: Began compiling node test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493
[0m14:53:39.660147 [debug] [Thread-5 (]: Writing injected SQL for node "test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:53:39.660761 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493 (compile): 14:53:39.656803 => 14:53:39.660582
[0m14:53:39.661062 [debug] [Thread-5 (]: Began executing node test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493
[0m14:53:39.662614 [debug] [Thread-5 (]: Writing runtime sql for node "test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:53:39.663058 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:53:39.663320 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m14:53:39.663572 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m14:53:39.666198 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m14:53:39.666491 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:53:39.666762 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."main"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:53:39.667466 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m14:53:39.668434 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493 (execute): 14:53:39.661220 => 14:53:39.668285
[0m14:53:39.668703 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m14:53:39.669345 [debug] [Thread-5 (]: Failed to rollback 'test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493'
[0m14:53:39.669588 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m14:53:39.670787 [info ] [Thread-5 (]: 3 of 3 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.01s]
[0m14:53:39.671227 [debug] [Thread-5 (]: Finished running node test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493
[0m14:53:39.672111 [debug] [MainThread]: Using duckdb connection "master"
[0m14:53:39.672354 [debug] [MainThread]: On master: BEGIN
[0m14:53:39.672582 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:53:39.674989 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:53:39.675222 [debug] [MainThread]: On master: COMMIT
[0m14:53:39.675441 [debug] [MainThread]: Using duckdb connection "master"
[0m14:53:39.675659 [debug] [MainThread]: On master: COMMIT
[0m14:53:39.675899 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:53:39.676118 [debug] [MainThread]: On master: Close
[0m14:53:39.677077 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:39.677317 [debug] [MainThread]: Connection 'test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m14:53:39.677570 [info ] [MainThread]: 
[0m14:53:39.677819 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m14:53:39.678367 [debug] [MainThread]: Command end result
[0m14:53:39.682915 [info ] [MainThread]: 
[0m14:53:39.683231 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:53:39.683454 [info ] [MainThread]: 
[0m14:53:39.683699 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:53:39.684000 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.14812325, "process_user_time": 2.226191, "process_kernel_time": 0.215773, "process_mem_max_rss": "164528128", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:53:39.684311 [debug] [MainThread]: Command `cli test` succeeded at 14:53:39.684225 after 0.15 seconds
[0m14:53:39.684588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063bbca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113f2a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114d3700>]}
[0m14:53:39.684857 [debug] [MainThread]: Flushing usage events
[0m14:55:01.907312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10636d8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10805fee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10805fb20>]}


============================== 14:55:01.909710 | eafda639-938f-493f-af4d-834fafc171cf ==============================
[0m14:55:01.909710 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:55:01.910112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:55:02.061654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eafda639-938f-493f-af4d-834fafc171cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080da770>]}
[0m14:55:02.109450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eafda639-938f-493f-af4d-834fafc171cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083db3d0>]}
[0m14:55:02.110002 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m14:55:02.118729 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m14:55:02.139658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:55:02.139947 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:55:02.143208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eafda639-938f-493f-af4d-834fafc171cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086aa0e0>]}
[0m14:55:02.143732 [info ] [MainThread]: Performance info: /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/target/perf_info.json
[0m14:55:02.150135 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 0.27575603, "process_user_time": 1.394716, "process_kernel_time": 0.128563, "process_mem_max_rss": "134496256", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:55:02.150529 [debug] [MainThread]: Command `cli parse` succeeded at 14:55:02.150433 after 0.28 seconds
[0m14:55:02.150824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10636d8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086811b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108681240>]}
[0m14:55:02.151085 [debug] [MainThread]: Flushing usage events
[0m14:55:02.598469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e54280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10805f160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10805ef80>]}


============================== 14:55:02.599152 | fa220d54-1a5e-4974-86b3-96ea96b4cb4c ==============================
[0m14:55:02.599152 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:55:02.599494 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:55:02.616907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa220d54-1a5e-4974-86b3-96ea96b4cb4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f98a0>]}
[0m14:55:02.618152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa220d54-1a5e-4974-86b3-96ea96b4cb4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10805f0a0>]}
[0m14:55:02.618768 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m14:55:02.620764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa220d54-1a5e-4974-86b3-96ea96b4cb4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10836e3b0>]}
[0m14:55:02.621223 [info ] [MainThread]: Found 2 models, 3 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m14:55:02.621604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa220d54-1a5e-4974-86b3-96ea96b4cb4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e9120>]}
[0m14:55:02.623009 [info ] [MainThread]: 
[0m14:55:02.623496 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:55:02.624319 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:55:02.628853 [debug] [ThreadPool]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m14:55:02.886055 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:55:02.887583 [debug] [ThreadPool]: On list_dev: 
    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m14:55:02.888043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:02.895211 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:55:02.899324 [debug] [ThreadPool]: On list_dev: Close
[0m14:55:02.900424 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m14:55:02.904092 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m14:55:02.906710 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:55:02.906959 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m14:55:02.907172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:02.909488 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:55:02.909721 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:55:02.909931 [debug] [ThreadPool]: On create_dev_main: create schema if not exists "dev"."main"
[0m14:55:02.910181 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:55:02.910693 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:55:02.910909 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:55:02.911111 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:55:02.911346 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:55:02.911557 [debug] [ThreadPool]: On create_dev_main: Close
[0m14:55:02.912794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m14:55:02.915871 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:55:02.916110 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:55:02.916320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:02.918508 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:55:02.918740 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:55:02.918953 [debug] [ThreadPool]: On list_dev_main: select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m14:55:02.928265 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:55:02.930740 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:55:02.931517 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:55:02.931732 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:55:02.933173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa220d54-1a5e-4974-86b3-96ea96b4cb4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e9450>]}
[0m14:55:02.933478 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:02.933690 [debug] [MainThread]: On master: BEGIN
[0m14:55:02.933888 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:55:02.936005 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:55:02.936230 [debug] [MainThread]: On master: COMMIT
[0m14:55:02.936437 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:02.936637 [debug] [MainThread]: On master: COMMIT
[0m14:55:02.936857 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:55:02.937055 [debug] [MainThread]: On master: Close
[0m14:55:02.937850 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:55:02.938111 [info ] [MainThread]: 
[0m14:55:02.939124 [debug] [Thread-1 (]: Began running node model.duckdb_sample_project.my_first_dbt_model
[0m14:55:02.939519 [info ] [Thread-1 (]: 1 of 2 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m14:55:02.939770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.duckdb_sample_project.my_first_dbt_model)
[0m14:55:02.940012 [debug] [Thread-1 (]: Began compiling node model.duckdb_sample_project.my_first_dbt_model
[0m14:55:02.944814 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_sample_project.my_first_dbt_model"
[0m14:55:02.945394 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_first_dbt_model (compile): 14:55:02.940167 => 14:55:02.945246
[0m14:55:02.945665 [debug] [Thread-1 (]: Began executing node model.duckdb_sample_project.my_first_dbt_model
[0m14:55:02.964704 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_sample_project.my_first_dbt_model"
[0m14:55:02.965335 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:55:02.965628 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: BEGIN
[0m14:55:02.965878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:02.968493 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:55:02.968760 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:55:02.969015 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: 
  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m14:55:02.969528 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:55:02.973048 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:55:02.973327 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:55:02.973680 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:55:02.975501 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:55:02.975746 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:55:02.976040 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:55:02.987545 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: COMMIT
[0m14:55:02.987857 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:55:02.988120 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: COMMIT
[0m14:55:02.988649 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:55:02.991736 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m14:55:02.991997 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m14:55:02.992390 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:55:02.993235 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_first_dbt_model (execute): 14:55:02.945826 => 14:55:02.993100
[0m14:55:02.993486 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: Close
[0m14:55:02.994912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa220d54-1a5e-4974-86b3-96ea96b4cb4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10866eb00>]}
[0m14:55:02.995308 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m14:55:02.995682 [debug] [Thread-1 (]: Finished running node model.duckdb_sample_project.my_first_dbt_model
[0m14:55:02.996137 [debug] [Thread-1 (]: Began running node model.duckdb_sample_project.my_second_dbt_model
[0m14:55:02.996481 [info ] [Thread-1 (]: 2 of 2 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m14:55:02.996735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.duckdb_sample_project.my_first_dbt_model, now model.duckdb_sample_project.my_second_dbt_model)
[0m14:55:02.996988 [debug] [Thread-1 (]: Began compiling node model.duckdb_sample_project.my_second_dbt_model
[0m14:55:02.998602 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_sample_project.my_second_dbt_model"
[0m14:55:02.999062 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_second_dbt_model (compile): 14:55:02.997141 => 14:55:02.998929
[0m14:55:02.999314 [debug] [Thread-1 (]: Began executing node model.duckdb_sample_project.my_second_dbt_model
[0m14:55:03.010416 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_sample_project.my_second_dbt_model"
[0m14:55:03.010924 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:55:03.011188 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: BEGIN
[0m14:55:03.011425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:03.013941 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:55:03.014210 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:55:03.014449 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: 
  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m14:55:03.014772 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:55:03.016643 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:55:03.016895 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m14:55:03.017199 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:55:03.018890 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:55:03.019136 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:55:03.019428 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:55:03.020617 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: COMMIT
[0m14:55:03.020880 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:55:03.021114 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: COMMIT
[0m14:55:03.021497 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:55:03.023029 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m14:55:03.023289 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m14:55:03.023667 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:55:03.024555 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_second_dbt_model (execute): 14:55:02.999474 => 14:55:03.024426
[0m14:55:03.024810 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: Close
[0m14:55:03.025995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa220d54-1a5e-4974-86b3-96ea96b4cb4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d4250>]}
[0m14:55:03.026397 [info ] [Thread-1 (]: 2 of 2 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.03s]
[0m14:55:03.026763 [debug] [Thread-1 (]: Finished running node model.duckdb_sample_project.my_second_dbt_model
[0m14:55:03.027317 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:03.027551 [debug] [MainThread]: On master: BEGIN
[0m14:55:03.027768 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:55:03.030086 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:55:03.030315 [debug] [MainThread]: On master: COMMIT
[0m14:55:03.030522 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:03.030724 [debug] [MainThread]: On master: COMMIT
[0m14:55:03.030944 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:55:03.031148 [debug] [MainThread]: On master: Close
[0m14:55:03.031961 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:03.032185 [debug] [MainThread]: Connection 'model.duckdb_sample_project.my_second_dbt_model' was properly closed.
[0m14:55:03.032404 [info ] [MainThread]: 
[0m14:55:03.032649 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m14:55:03.033115 [debug] [MainThread]: Command end result
[0m14:55:03.037308 [info ] [MainThread]: 
[0m14:55:03.037590 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:55:03.037824 [info ] [MainThread]: 
[0m14:55:03.038069 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:55:03.038383 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4420086, "process_user_time": 1.822884, "process_kernel_time": 0.15466, "process_mem_max_rss": "150093824", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:55:03.038683 [debug] [MainThread]: Command `cli run` succeeded at 14:55:03.038606 after 0.44 seconds
[0m14:55:03.038947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e54280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e9120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083203a0>]}
[0m14:55:03.039205 [debug] [MainThread]: Flushing usage events
[0m14:55:03.375594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10636fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10636fb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086804c0>]}


============================== 14:55:03.375956 | 7165d84e-b487-45f3-9649-718a7038de34 ==============================
[0m14:55:03.375956 [info ] [MainThread]: Running with dbt=1.7.2
[0m14:55:03.376288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:55:03.387653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7165d84e-b487-45f3-9649-718a7038de34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086803a0>]}
[0m14:55:03.388505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7165d84e-b487-45f3-9649-718a7038de34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f98a0>]}
[0m14:55:03.388818 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m14:55:03.392172 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m14:55:03.408783 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:55:03.409131 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:55:03.412288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7165d84e-b487-45f3-9649-718a7038de34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10967c0d0>]}
[0m14:55:03.417306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7165d84e-b487-45f3-9649-718a7038de34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d1120>]}
[0m14:55:03.417631 [info ] [MainThread]: Found 2 models, 3 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m14:55:03.417890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7165d84e-b487-45f3-9649-718a7038de34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d35e0>]}
[0m14:55:03.418481 [info ] [MainThread]: 
[0m14:55:03.418925 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:55:03.419513 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m14:55:03.420798 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:55:03.421044 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:55:03.421261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:03.424117 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:55:03.424427 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:55:03.424666 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m14:55:03.434436 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:55:03.437071 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:55:03.437773 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:55:03.438004 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:55:03.439714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7165d84e-b487-45f3-9649-718a7038de34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109402f80>]}
[0m14:55:03.440043 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:03.440267 [debug] [MainThread]: On master: BEGIN
[0m14:55:03.440472 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:55:03.442906 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:55:03.443140 [debug] [MainThread]: On master: COMMIT
[0m14:55:03.443361 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:03.443560 [debug] [MainThread]: On master: COMMIT
[0m14:55:03.443777 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:55:03.443978 [debug] [MainThread]: On master: Close
[0m14:55:03.444914 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:55:03.445172 [info ] [MainThread]: 
[0m14:55:03.445973 [debug] [Thread-5 (]: Began running node test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778
[0m14:55:03.446253 [info ] [Thread-5 (]: 1 of 3 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m14:55:03.446670 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly list_dev_main, now test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778)
[0m14:55:03.446914 [debug] [Thread-5 (]: Began compiling node test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778
[0m14:55:03.454116 [debug] [Thread-5 (]: Writing injected SQL for node "test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778"
[0m14:55:03.454732 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778 (compile): 14:55:03.447071 => 14:55:03.454563
[0m14:55:03.454994 [debug] [Thread-5 (]: Began executing node test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778
[0m14:55:03.463576 [debug] [Thread-5 (]: Writing runtime sql for node "test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778"
[0m14:55:03.464229 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778"
[0m14:55:03.464520 [debug] [Thread-5 (]: On test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m14:55:03.464786 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m14:55:03.467240 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m14:55:03.467510 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778"
[0m14:55:03.467757 [debug] [Thread-5 (]: On test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."main"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m14:55:03.468298 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m14:55:03.469565 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778 (execute): 14:55:03.455149 => 14:55:03.469416
[0m14:55:03.469839 [debug] [Thread-5 (]: On test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m14:55:03.470491 [debug] [Thread-5 (]: Failed to rollback 'test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778'
[0m14:55:03.470746 [debug] [Thread-5 (]: On test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778: Close
[0m14:55:03.471929 [info ] [Thread-5 (]: 1 of 3 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.03s]
[0m14:55:03.472345 [debug] [Thread-5 (]: Finished running node test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778
[0m14:55:03.472649 [debug] [Thread-5 (]: Began running node test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321
[0m14:55:03.472950 [info ] [Thread-5 (]: 2 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m14:55:03.473358 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778, now test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321)
[0m14:55:03.473608 [debug] [Thread-5 (]: Began compiling node test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321
[0m14:55:03.477429 [debug] [Thread-5 (]: Writing injected SQL for node "test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321"
[0m14:55:03.477965 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321 (compile): 14:55:03.473768 => 14:55:03.477829
[0m14:55:03.478241 [debug] [Thread-5 (]: Began executing node test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321
[0m14:55:03.479703 [debug] [Thread-5 (]: Writing runtime sql for node "test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321"
[0m14:55:03.480123 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321"
[0m14:55:03.480369 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m14:55:03.480602 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m14:55:03.483043 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m14:55:03.483311 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321"
[0m14:55:03.483602 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."main"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:55:03.484428 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m14:55:03.485446 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321 (execute): 14:55:03.478408 => 14:55:03.485291
[0m14:55:03.485716 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m14:55:03.486334 [debug] [Thread-5 (]: Failed to rollback 'test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321'
[0m14:55:03.486576 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321: Close
[0m14:55:03.487839 [info ] [Thread-5 (]: 2 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.01s]
[0m14:55:03.488312 [debug] [Thread-5 (]: Finished running node test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321
[0m14:55:03.488624 [debug] [Thread-5 (]: Began running node test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493
[0m14:55:03.488939 [info ] [Thread-5 (]: 3 of 3 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m14:55:03.489357 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321, now test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493)
[0m14:55:03.489630 [debug] [Thread-5 (]: Began compiling node test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493
[0m14:55:03.523565 [debug] [Thread-5 (]: Writing injected SQL for node "test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:55:03.524249 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493 (compile): 14:55:03.489789 => 14:55:03.524101
[0m14:55:03.524523 [debug] [Thread-5 (]: Began executing node test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493
[0m14:55:03.526145 [debug] [Thread-5 (]: Writing runtime sql for node "test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:55:03.526637 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:55:03.526913 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m14:55:03.527165 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m14:55:03.529782 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m14:55:03.530033 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:55:03.530284 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."main"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:55:03.530960 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m14:55:03.531862 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493 (execute): 14:55:03.524690 => 14:55:03.531718
[0m14:55:03.532133 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m14:55:03.532810 [debug] [Thread-5 (]: Failed to rollback 'test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493'
[0m14:55:03.533107 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m14:55:03.534307 [info ] [Thread-5 (]: 3 of 3 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.05s]
[0m14:55:03.534733 [debug] [Thread-5 (]: Finished running node test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493
[0m14:55:03.535491 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:03.535733 [debug] [MainThread]: On master: BEGIN
[0m14:55:03.535955 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:55:03.538204 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:55:03.538431 [debug] [MainThread]: On master: COMMIT
[0m14:55:03.538658 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:03.538888 [debug] [MainThread]: On master: COMMIT
[0m14:55:03.539126 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:55:03.539354 [debug] [MainThread]: On master: Close
[0m14:55:03.540315 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:03.540547 [debug] [MainThread]: Connection 'test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m14:55:03.540775 [info ] [MainThread]: 
[0m14:55:03.541016 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m14:55:03.541536 [debug] [MainThread]: Command end result
[0m14:55:03.546040 [info ] [MainThread]: 
[0m14:55:03.546322 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:55:03.546556 [info ] [MainThread]: 
[0m14:55:03.546799 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:55:03.547103 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.17243662, "process_user_time": 1.994789, "process_kernel_time": 0.174505, "process_mem_max_rss": "154828800", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:55:03.547408 [debug] [MainThread]: Command `cli test` succeeded at 14:55:03.547325 after 0.17 seconds
[0m14:55:03.547662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10636fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096b3280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109435240>]}
[0m14:55:03.547914 [debug] [MainThread]: Flushing usage events
[0m15:06:33.643438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a72b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d29930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d29480>]}


============================== 15:06:33.646619 | 89031bb0-e2a3-4c15-b417-076ff856cf0c ==============================
[0m15:06:33.646619 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:06:33.647009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt check --config=sample-config.json', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:06:33.647409 [info ] [MainThread]: dbt version: 1.7.2
[0m15:06:33.647635 [info ] [MainThread]: python version: 3.10.12
[0m15:06:33.647848 [info ] [MainThread]: python path: /Users/ajsteers/Library/Caches/pypoetry/virtualenvs/source-dbt-duckdb-wArIZlx6-py3.10/bin/python
[0m15:06:33.648055 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m15:06:33.763370 [info ] [MainThread]: Using profiles dir at /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project
[0m15:06:33.763735 [info ] [MainThread]: Using profiles.yml file at /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/profiles.yml
[0m15:06:33.763977 [info ] [MainThread]: Using dbt_project.yml file at /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/dbt_project.yml
[0m15:06:33.764492 [info ] [MainThread]: adapter type: duckdb
[0m15:06:33.764755 [info ] [MainThread]: adapter version: 1.7.0
[0m15:06:33.808024 [info ] [MainThread]: Configuration:
[0m15:06:33.808436 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:06:33.808684 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:06:33.808909 [info ] [MainThread]: Required dependencies:
[0m15:06:33.809203 [debug] [MainThread]: Executing "git --help"
[0m15:06:33.824278 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:06:33.825015 [debug] [MainThread]: STDERR: "b''"
[0m15:06:33.825397 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:06:33.825661 [info ] [MainThread]: Connection:
[0m15:06:33.825930 [info ] [MainThread]:   database: dev
[0m15:06:33.826149 [info ] [MainThread]:   schema: main
[0m15:06:33.826355 [info ] [MainThread]:   path: /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/unit_tests/artifacts/dev.duckdb
[0m15:06:33.826568 [info ] [MainThread]:   config_options: None
[0m15:06:33.826775 [info ] [MainThread]:   extensions: None
[0m15:06:33.826990 [info ] [MainThread]:   settings: None
[0m15:06:33.827204 [info ] [MainThread]:   external_root: .
[0m15:06:33.827418 [info ] [MainThread]:   use_credential_provider: None
[0m15:06:33.827615 [info ] [MainThread]:   attach: None
[0m15:06:33.827830 [info ] [MainThread]:   filesystems: None
[0m15:06:33.828027 [info ] [MainThread]:   remote: None
[0m15:06:33.828228 [info ] [MainThread]:   plugins: None
[0m15:06:33.828430 [info ] [MainThread]:   disable_transactions: False
[0m15:06:33.828746 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m15:06:33.833522 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m15:06:33.834139 [debug] [MainThread]: Using duckdb connection "debug"
[0m15:06:33.834385 [debug] [MainThread]: On debug: select 1 as id
[0m15:06:33.834608 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:06:33.843662 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:06:33.844559 [debug] [MainThread]: On debug: Close
[0m15:06:33.846004 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:06:33.846257 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:06:33.847602 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.23959196, "process_user_time": 1.384202, "process_kernel_time": 0.179285, "process_mem_max_rss": "127352832", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:06:33.848041 [debug] [MainThread]: Command `cli debug` succeeded at 15:06:33.847948 after 0.24 seconds
[0m15:06:33.848297 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:06:33.848556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a72b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de7b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f7baf0>]}
[0m15:06:33.848859 [debug] [MainThread]: Flushing usage events
[0m15:11:07.720659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db1870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10953afe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10953beb0>]}


============================== 15:11:07.723993 | f89c6371-e97e-41be-9e1d-2559e01cb791 ==============================
[0m15:11:07.723993 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:11:07.724400 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:11:07.923920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f89c6371-e97e-41be-9e1d-2559e01cb791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095bb7f0>]}
[0m15:11:07.973599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f89c6371-e97e-41be-9e1d-2559e01cb791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097c35e0>]}
[0m15:11:07.974332 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m15:11:07.984258 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:11:08.015567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:11:08.015889 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:11:08.019614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f89c6371-e97e-41be-9e1d-2559e01cb791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109992440>]}
[0m15:11:08.020251 [info ] [MainThread]: Performance info: /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/target/perf_info.json
[0m15:11:08.027657 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 0.3417634, "process_user_time": 1.403388, "process_kernel_time": 0.143006, "process_mem_max_rss": "132956160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:11:08.028083 [debug] [MainThread]: Command `cli parse` succeeded at 15:11:08.027981 after 0.34 seconds
[0m15:11:08.028373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db1870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109965540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109965660>]}
[0m15:11:08.028640 [debug] [MainThread]: Flushing usage events
[0m15:11:08.477044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078fc280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10953b4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10953b340>]}


============================== 15:11:08.477594 | 888fa762-6469-428a-b0e8-3374d6e773b6 ==============================
[0m15:11:08.477594 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:11:08.478085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:11:08.494574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '888fa762-6469-428a-b0e8-3374d6e773b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109473700>]}
[0m15:11:08.495798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '888fa762-6469-428a-b0e8-3374d6e773b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095bb7f0>]}
[0m15:11:08.496202 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m15:11:08.498744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '888fa762-6469-428a-b0e8-3374d6e773b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10974de10>]}
[0m15:11:08.499127 [info ] [MainThread]: Found 2 models, 3 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m15:11:08.499451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '888fa762-6469-428a-b0e8-3374d6e773b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097c35e0>]}
[0m15:11:08.500702 [info ] [MainThread]: 
[0m15:11:08.501049 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:11:08.501696 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:11:08.505471 [debug] [ThreadPool]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:11:08.753200 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:11:08.753549 [debug] [ThreadPool]: On list_dev: 
    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m15:11:08.753802 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:08.764016 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:11:08.765844 [debug] [ThreadPool]: On list_dev: Close
[0m15:11:08.767157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:11:08.767430 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:11:08.769953 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:11:08.770189 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:11:08.770403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:08.772806 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:11:08.773035 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:11:08.773254 [debug] [ThreadPool]: On create_dev_main: create schema if not exists "dev"."main"
[0m15:11:08.773551 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:11:08.774060 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:11:08.774287 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:11:08.774500 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:11:08.774756 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:11:08.774974 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:11:08.776021 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:11:08.779123 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:11:08.779363 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:11:08.779576 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:08.781728 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:11:08.781964 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:11:08.782213 [debug] [ThreadPool]: On list_dev_main: select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m15:11:08.792633 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:11:08.795502 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:11:08.796576 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:11:08.796811 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:11:08.798402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '888fa762-6469-428a-b0e8-3374d6e773b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10974d060>]}
[0m15:11:08.798713 [debug] [MainThread]: Using duckdb connection "master"
[0m15:11:08.798936 [debug] [MainThread]: On master: BEGIN
[0m15:11:08.799135 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:08.801414 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:11:08.801659 [debug] [MainThread]: On master: COMMIT
[0m15:11:08.801871 [debug] [MainThread]: Using duckdb connection "master"
[0m15:11:08.802072 [debug] [MainThread]: On master: COMMIT
[0m15:11:08.802293 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:11:08.802496 [debug] [MainThread]: On master: Close
[0m15:11:08.803323 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:11:08.803697 [info ] [MainThread]: 
[0m15:11:08.805114 [debug] [Thread-1 (]: Began running node model.duckdb_sample_project.my_first_dbt_model
[0m15:11:08.805551 [info ] [Thread-1 (]: 1 of 2 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m15:11:08.805835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.duckdb_sample_project.my_first_dbt_model)
[0m15:11:08.806089 [debug] [Thread-1 (]: Began compiling node model.duckdb_sample_project.my_first_dbt_model
[0m15:11:08.811045 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_sample_project.my_first_dbt_model"
[0m15:11:08.811672 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_first_dbt_model (compile): 15:11:08.806245 => 15:11:08.811523
[0m15:11:08.811940 [debug] [Thread-1 (]: Began executing node model.duckdb_sample_project.my_first_dbt_model
[0m15:11:08.831206 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_sample_project.my_first_dbt_model"
[0m15:11:08.831840 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m15:11:08.832110 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: BEGIN
[0m15:11:08.832366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:08.834836 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:08.835099 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m15:11:08.835348 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: 
  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m15:11:08.837340 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:08.841021 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m15:11:08.841287 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:11:08.841716 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:08.843499 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m15:11:08.843761 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:11:08.844123 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:08.855131 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: COMMIT
[0m15:11:08.855431 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m15:11:08.855680 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: COMMIT
[0m15:11:08.856332 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:08.859305 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m15:11:08.859607 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m15:11:08.860012 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:08.860826 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_first_dbt_model (execute): 15:11:08.812096 => 15:11:08.860691
[0m15:11:08.861079 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: Close
[0m15:11:08.863059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '888fa762-6469-428a-b0e8-3374d6e773b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10994f250>]}
[0m15:11:08.863457 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m15:11:08.863847 [debug] [Thread-1 (]: Finished running node model.duckdb_sample_project.my_first_dbt_model
[0m15:11:08.864334 [debug] [Thread-1 (]: Began running node model.duckdb_sample_project.my_second_dbt_model
[0m15:11:08.864754 [info ] [Thread-1 (]: 2 of 2 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m15:11:08.865054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.duckdb_sample_project.my_first_dbt_model, now model.duckdb_sample_project.my_second_dbt_model)
[0m15:11:08.865329 [debug] [Thread-1 (]: Began compiling node model.duckdb_sample_project.my_second_dbt_model
[0m15:11:08.866998 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_sample_project.my_second_dbt_model"
[0m15:11:08.867508 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_second_dbt_model (compile): 15:11:08.865495 => 15:11:08.867366
[0m15:11:08.867771 [debug] [Thread-1 (]: Began executing node model.duckdb_sample_project.my_second_dbt_model
[0m15:11:08.879455 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_sample_project.my_second_dbt_model"
[0m15:11:08.880033 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m15:11:08.880299 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: BEGIN
[0m15:11:08.880538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:08.883145 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:08.883433 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m15:11:08.883701 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: 
  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m15:11:08.884053 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:08.886132 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m15:11:08.886426 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m15:11:08.886771 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:08.888640 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m15:11:08.888913 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:11:08.889228 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:08.890495 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: COMMIT
[0m15:11:08.890767 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m15:11:08.891021 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: COMMIT
[0m15:11:08.891455 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:08.893267 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m15:11:08.893616 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m15:11:08.894049 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:08.894983 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_second_dbt_model (execute): 15:11:08.867935 => 15:11:08.894840
[0m15:11:08.895258 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: Close
[0m15:11:08.896588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '888fa762-6469-428a-b0e8-3374d6e773b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a305b0>]}
[0m15:11:08.896992 [info ] [Thread-1 (]: 2 of 2 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.03s]
[0m15:11:08.897382 [debug] [Thread-1 (]: Finished running node model.duckdb_sample_project.my_second_dbt_model
[0m15:11:08.897970 [debug] [MainThread]: Using duckdb connection "master"
[0m15:11:08.898194 [debug] [MainThread]: On master: BEGIN
[0m15:11:08.898403 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:11:08.900868 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:11:08.901120 [debug] [MainThread]: On master: COMMIT
[0m15:11:08.901346 [debug] [MainThread]: Using duckdb connection "master"
[0m15:11:08.901565 [debug] [MainThread]: On master: COMMIT
[0m15:11:08.901811 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:11:08.902034 [debug] [MainThread]: On master: Close
[0m15:11:08.902836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:11:08.903051 [debug] [MainThread]: Connection 'model.duckdb_sample_project.my_second_dbt_model' was properly closed.
[0m15:11:08.903291 [info ] [MainThread]: 
[0m15:11:08.903534 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m15:11:08.903997 [debug] [MainThread]: Command end result
[0m15:11:08.908742 [info ] [MainThread]: 
[0m15:11:08.909058 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:11:08.909309 [info ] [MainThread]: 
[0m15:11:08.909569 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:11:08.909892 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.43449062, "process_user_time": 1.822542, "process_kernel_time": 0.172621, "process_mem_max_rss": "150044672", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:11:08.910199 [debug] [MainThread]: Command `cli run` succeeded at 15:11:08.910120 after 0.43 seconds
[0m15:11:08.910450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078fc280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095bb7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096cf100>]}
[0m15:11:08.910723 [debug] [MainThread]: Flushing usage events
[0m15:11:09.248548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db3c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db3b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10994f2e0>]}


============================== 15:11:09.249169 | 239250dd-be81-40b9-87bd-1e27244905b8 ==============================
[0m15:11:09.249169 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:11:09.249733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:11:09.267542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '239250dd-be81-40b9-87bd-1e27244905b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10974e5f0>]}
[0m15:11:09.268739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '239250dd-be81-40b9-87bd-1e27244905b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b480d0>]}
[0m15:11:09.269170 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m15:11:09.273361 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m15:11:09.293568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:11:09.294018 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:11:09.297931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '239250dd-be81-40b9-87bd-1e27244905b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c540d0>]}
[0m15:11:09.303906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '239250dd-be81-40b9-87bd-1e27244905b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109abd630>]}
[0m15:11:09.304269 [info ] [MainThread]: Found 2 models, 3 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m15:11:09.304544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '239250dd-be81-40b9-87bd-1e27244905b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109abf5b0>]}
[0m15:11:09.305208 [info ] [MainThread]: 
[0m15:11:09.305698 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:11:09.306799 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m15:11:09.309289 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:11:09.309632 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:11:09.309897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:09.312807 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:11:09.313083 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:11:09.313338 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m15:11:09.323905 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:11:09.326768 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:11:09.327474 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:11:09.327726 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:11:09.329699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '239250dd-be81-40b9-87bd-1e27244905b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b1ccd0>]}
[0m15:11:09.330097 [debug] [MainThread]: Using duckdb connection "master"
[0m15:11:09.330352 [debug] [MainThread]: On master: BEGIN
[0m15:11:09.330582 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:09.333484 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:11:09.333837 [debug] [MainThread]: On master: COMMIT
[0m15:11:09.334093 [debug] [MainThread]: Using duckdb connection "master"
[0m15:11:09.334326 [debug] [MainThread]: On master: COMMIT
[0m15:11:09.334589 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:11:09.334829 [debug] [MainThread]: On master: Close
[0m15:11:09.336242 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:11:09.336629 [info ] [MainThread]: 
[0m15:11:09.338888 [debug] [Thread-5 (]: Began running node test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778
[0m15:11:09.339326 [info ] [Thread-5 (]: 1 of 3 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m15:11:09.339833 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly list_dev_main, now test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778)
[0m15:11:09.340119 [debug] [Thread-5 (]: Began compiling node test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778
[0m15:11:09.347981 [debug] [Thread-5 (]: Writing injected SQL for node "test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778"
[0m15:11:09.348656 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778 (compile): 15:11:09.340290 => 15:11:09.348436
[0m15:11:09.348962 [debug] [Thread-5 (]: Began executing node test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778
[0m15:11:09.357457 [debug] [Thread-5 (]: Writing runtime sql for node "test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778"
[0m15:11:09.357998 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778"
[0m15:11:09.358341 [debug] [Thread-5 (]: On test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m15:11:09.358645 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m15:11:09.361298 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m15:11:09.361593 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778"
[0m15:11:09.361876 [debug] [Thread-5 (]: On test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."main"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m15:11:09.363002 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m15:11:09.364701 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778 (execute): 15:11:09.349136 => 15:11:09.364508
[0m15:11:09.365030 [debug] [Thread-5 (]: On test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m15:11:09.365785 [debug] [Thread-5 (]: Failed to rollback 'test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778'
[0m15:11:09.366124 [debug] [Thread-5 (]: On test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778: Close
[0m15:11:09.367476 [info ] [Thread-5 (]: 1 of 3 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.03s]
[0m15:11:09.367923 [debug] [Thread-5 (]: Finished running node test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778
[0m15:11:09.368240 [debug] [Thread-5 (]: Began running node test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321
[0m15:11:09.368593 [info ] [Thread-5 (]: 2 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m15:11:09.369079 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778, now test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321)
[0m15:11:09.369368 [debug] [Thread-5 (]: Began compiling node test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321
[0m15:11:09.373668 [debug] [Thread-5 (]: Writing injected SQL for node "test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321"
[0m15:11:09.374290 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321 (compile): 15:11:09.369545 => 15:11:09.374133
[0m15:11:09.374576 [debug] [Thread-5 (]: Began executing node test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321
[0m15:11:09.376152 [debug] [Thread-5 (]: Writing runtime sql for node "test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321"
[0m15:11:09.376582 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321"
[0m15:11:09.376850 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m15:11:09.377102 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m15:11:09.379796 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m15:11:09.380095 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321"
[0m15:11:09.380369 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."main"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:11:09.382798 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m15:11:09.383943 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321 (execute): 15:11:09.374747 => 15:11:09.383774
[0m15:11:09.384249 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m15:11:09.384915 [debug] [Thread-5 (]: Failed to rollback 'test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321'
[0m15:11:09.385181 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321: Close
[0m15:11:09.386447 [info ] [Thread-5 (]: 2 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.02s]
[0m15:11:09.386858 [debug] [Thread-5 (]: Finished running node test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321
[0m15:11:09.387167 [debug] [Thread-5 (]: Began running node test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493
[0m15:11:09.387552 [info ] [Thread-5 (]: 3 of 3 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m15:11:09.388078 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321, now test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493)
[0m15:11:09.388375 [debug] [Thread-5 (]: Began compiling node test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493
[0m15:11:09.425396 [debug] [Thread-5 (]: Writing injected SQL for node "test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:11:09.426059 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493 (compile): 15:11:09.388547 => 15:11:09.425903
[0m15:11:09.426343 [debug] [Thread-5 (]: Began executing node test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493
[0m15:11:09.428001 [debug] [Thread-5 (]: Writing runtime sql for node "test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:11:09.428491 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:11:09.428758 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m15:11:09.429007 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m15:11:09.431692 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m15:11:09.431981 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:11:09.432258 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.2", "profile_name": "duckdb_sample_project", "target_name": "dev", "node_id": "test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."main"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:11:09.433062 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m15:11:09.434082 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493 (execute): 15:11:09.426516 => 15:11:09.433921
[0m15:11:09.434388 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m15:11:09.435400 [debug] [Thread-5 (]: Failed to rollback 'test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493'
[0m15:11:09.435713 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m15:11:09.437256 [info ] [Thread-5 (]: 3 of 3 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.05s]
[0m15:11:09.437759 [debug] [Thread-5 (]: Finished running node test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493
[0m15:11:09.438601 [debug] [MainThread]: Using duckdb connection "master"
[0m15:11:09.438853 [debug] [MainThread]: On master: BEGIN
[0m15:11:09.439082 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:11:09.441724 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:11:09.442024 [debug] [MainThread]: On master: COMMIT
[0m15:11:09.442272 [debug] [MainThread]: Using duckdb connection "master"
[0m15:11:09.442505 [debug] [MainThread]: On master: COMMIT
[0m15:11:09.442761 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:11:09.442991 [debug] [MainThread]: On master: Close
[0m15:11:09.444095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:11:09.444359 [debug] [MainThread]: Connection 'test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m15:11:09.444620 [info ] [MainThread]: 
[0m15:11:09.444884 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m15:11:09.445450 [debug] [MainThread]: Command end result
[0m15:11:09.450589 [info ] [MainThread]: 
[0m15:11:09.450973 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:11:09.451229 [info ] [MainThread]: 
[0m15:11:09.451481 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:11:09.451818 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.20484641, "process_user_time": 2.021986, "process_kernel_time": 0.198772, "process_mem_max_rss": "158433280", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:11:09.452146 [debug] [MainThread]: Command `cli test` succeeded at 15:11:09.452059 after 0.21 seconds
[0m15:11:09.452427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db3c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c8f5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109af1ab0>]}
[0m15:11:09.452715 [debug] [MainThread]: Flushing usage events
[0m15:11:14.988991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109119870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaa2fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaa3d60>]}


============================== 15:11:14.991353 | f93788b9-73cc-4caf-9935-41c4d7fe5fec ==============================
[0m15:11:14.991353 [info ] [MainThread]: Running with dbt=1.7.2
[0m15:11:14.991769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:11:14.992162 [info ] [MainThread]: dbt version: 1.7.2
[0m15:11:14.992423 [info ] [MainThread]: python version: 3.10.12
[0m15:11:14.992664 [info ] [MainThread]: python path: /Users/ajsteers/Library/Caches/pypoetry/virtualenvs/source-dbt-duckdb-wArIZlx6-py3.10/bin/python
[0m15:11:14.992921 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m15:11:15.087639 [info ] [MainThread]: Using profiles dir at /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project
[0m15:11:15.088087 [info ] [MainThread]: Using profiles.yml file at /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/profiles.yml
[0m15:11:15.088352 [info ] [MainThread]: Using dbt_project.yml file at /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/dbt_project.yml
[0m15:11:15.088819 [info ] [MainThread]: adapter type: duckdb
[0m15:11:15.089065 [info ] [MainThread]: adapter version: 1.7.0
[0m15:11:15.133519 [info ] [MainThread]: Configuration:
[0m15:11:15.133927 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:11:15.134195 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:11:15.134433 [info ] [MainThread]: Required dependencies:
[0m15:11:15.134754 [debug] [MainThread]: Executing "git --help"
[0m15:11:15.151239 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:11:15.152045 [debug] [MainThread]: STDERR: "b''"
[0m15:11:15.152366 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:11:15.152649 [info ] [MainThread]: Connection:
[0m15:11:15.152939 [info ] [MainThread]:   database: dev
[0m15:11:15.153177 [info ] [MainThread]:   schema: main
[0m15:11:15.153415 [info ] [MainThread]:   path: /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/unit_tests/artifacts/dev.duckdb
[0m15:11:15.153696 [info ] [MainThread]:   config_options: None
[0m15:11:15.153930 [info ] [MainThread]:   extensions: None
[0m15:11:15.154156 [info ] [MainThread]:   settings: None
[0m15:11:15.154380 [info ] [MainThread]:   external_root: .
[0m15:11:15.154596 [info ] [MainThread]:   use_credential_provider: None
[0m15:11:15.154826 [info ] [MainThread]:   attach: None
[0m15:11:15.155045 [info ] [MainThread]:   filesystems: None
[0m15:11:15.155266 [info ] [MainThread]:   remote: None
[0m15:11:15.155483 [info ] [MainThread]:   plugins: None
[0m15:11:15.155704 [info ] [MainThread]:   disable_transactions: False
[0m15:11:15.156117 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m15:11:15.160844 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m15:11:15.161608 [debug] [MainThread]: Using duckdb connection "debug"
[0m15:11:15.161935 [debug] [MainThread]: On debug: select 1 as id
[0m15:11:15.162183 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:15.166118 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:11:15.166941 [debug] [MainThread]: On debug: Close
[0m15:11:15.167824 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:11:15.168083 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:11:15.169214 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.21278575, "process_user_time": 1.329973, "process_kernel_time": 0.116043, "process_mem_max_rss": "134463488", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:11:15.169606 [debug] [MainThread]: Command `cli debug` succeeded at 15:11:15.169514 after 0.21 seconds
[0m15:11:15.169862 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:11:15.170128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109119870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaa00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ade58a0>]}
[0m15:11:15.170432 [debug] [MainThread]: Flushing usage events
[0m06:41:30.139532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a22a9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c3ab7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c3abc70>]}


============================== 06:41:30.142725 | f3c7f7b4-f3ea-4e23-9387-dde3f14bc208 ==============================
[0m06:41:30.142725 [info ] [MainThread]: Running with dbt=1.7.2
[0m06:41:30.143163 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:41:30.364536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3c7f7b4-f3ea-4e23-9387-dde3f14bc208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c3a93f0>]}
[0m06:41:30.411376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3c7f7b4-f3ea-4e23-9387-dde3f14bc208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c7e4ee0>]}
[0m06:41:30.412123 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m06:41:30.423131 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m06:41:30.429482 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m06:41:30.429787 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m06:41:30.430050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f3c7f7b4-f3ea-4e23-9387-dde3f14bc208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c7e4d30>]}
[0m06:41:30.904370 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m06:41:30.913227 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m06:41:31.042356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3c7f7b4-f3ea-4e23-9387-dde3f14bc208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ca73250>]}
[0m06:41:31.043350 [info ] [MainThread]: Performance info: /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/target/perf_info.json
[0m06:41:31.049587 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 0.94870985, "process_user_time": 1.968975, "process_kernel_time": 0.146793, "process_mem_max_rss": "142213120", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:31.049961 [debug] [MainThread]: Command `cli parse` succeeded at 06:41:31.049866 after 0.95 seconds
[0m06:41:31.050251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a22a9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c8c3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c76c400>]}
[0m06:41:31.050523 [debug] [MainThread]: Flushing usage events
[0m06:41:31.462444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181bf670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c30cca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c30fa60>]}


============================== 06:41:31.463258 | 20273a24-1909-4c36-b012-fb20c549bce6 ==============================
[0m06:41:31.463258 [info ] [MainThread]: Running with dbt=1.7.2
[0m06:41:31.464016 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:41:31.483586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20273a24-1909-4c36-b012-fb20c549bce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c42d4b0>]}
[0m06:41:31.484295 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m06:41:31.484874 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m06:41:31.485359 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.02512575, "process_user_time": 2.013793, "process_kernel_time": 0.15903, "process_mem_max_rss": "145981440", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:31.485846 [debug] [MainThread]: Command `cli deps` succeeded at 06:41:31.485701 after 0.03 seconds
[0m06:41:31.486225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181bf670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c387820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c7e5de0>]}
[0m06:41:31.486619 [debug] [MainThread]: Flushing usage events
[0m06:42:23.018911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eba6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10763bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10763bc10>]}


============================== 06:42:23.022127 | 2aa04957-20b4-4da8-9314-bc26683cd798 ==============================
[0m06:42:23.022127 [info ] [MainThread]: Running with dbt=1.7.2
[0m06:42:23.022555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:42:23.231416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2aa04957-20b4-4da8-9314-bc26683cd798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076393c0>]}
[0m06:42:23.278703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2aa04957-20b4-4da8-9314-bc26683cd798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078717b0>]}
[0m06:42:23.279617 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m06:42:23.289424 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m06:42:23.295538 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m06:42:23.295881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2aa04957-20b4-4da8-9314-bc26683cd798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c3310>]}
[0m06:42:23.772592 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m06:42:23.781590 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m06:42:23.913098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2aa04957-20b4-4da8-9314-bc26683cd798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a32620>]}
[0m06:42:23.913731 [info ] [MainThread]: Performance info: /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/target/perf_info.json
[0m06:42:23.919998 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 0.93689597, "process_user_time": 1.962133, "process_kernel_time": 0.145872, "process_mem_max_rss": "140181504", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:23.920379 [debug] [MainThread]: Command `cli parse` succeeded at 06:42:23.920279 after 0.94 seconds
[0m06:42:23.920648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eba6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107804190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a32950>]}
[0m06:42:23.920911 [debug] [MainThread]: Flushing usage events
[0m06:42:24.269799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10612f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10759d2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10759f5e0>]}


============================== 06:42:24.270435 | ce105116-a4e8-4167-860c-07b8b8bdd146 ==============================
[0m06:42:24.270435 [info ] [MainThread]: Running with dbt=1.7.2
[0m06:42:24.271003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:42:24.287207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce105116-a4e8-4167-860c-07b8b8bdd146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076be980>]}
[0m06:42:24.287801 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m06:42:24.288416 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m06:42:24.288841 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.021132626, "process_user_time": 1.99989, "process_kernel_time": 0.156006, "process_mem_max_rss": "143818752", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:24.289257 [debug] [MainThread]: Command `cli deps` succeeded at 06:42:24.289142 after 0.02 seconds
[0m06:42:24.289594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10612f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10759f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a32170>]}
[0m06:42:24.289939 [debug] [MainThread]: Flushing usage events
[0m06:43:36.640065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121eb6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154abe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154aba60>]}


============================== 06:43:36.643160 | cdfa29cd-fac7-4afc-ba82-09eee9cdee3c ==============================
[0m06:43:36.643160 [info ] [MainThread]: Running with dbt=1.7.2
[0m06:43:36.643556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:43:36.841410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdfa29cd-fac7-4afc-ba82-09eee9cdee3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154a93f0>]}
[0m06:43:36.889140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdfa29cd-fac7-4afc-ba82-09eee9cdee3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158101f0>]}
[0m06:43:36.890133 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m06:43:36.899869 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m06:43:36.906131 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m06:43:36.906482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cdfa29cd-fac7-4afc-ba82-09eee9cdee3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158f1240>]}
[0m06:43:37.389544 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m06:43:37.398581 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m06:43:37.536745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdfa29cd-fac7-4afc-ba82-09eee9cdee3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b949d0>]}
[0m06:43:37.537430 [info ] [MainThread]: Performance info: /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/target/perf_info.json
[0m06:43:37.543486 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 0.93814933, "process_user_time": 2.01077, "process_kernel_time": 0.163017, "process_mem_max_rss": "141377536", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:43:37.543857 [debug] [MainThread]: Command `cli parse` succeeded at 06:43:37.543757 after 0.94 seconds
[0m06:43:37.544126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121eb6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158101f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b97370>]}
[0m06:43:37.544381 [debug] [MainThread]: Flushing usage events
[0m06:43:37.968715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ac74c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11540ec20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11540f670>]}


============================== 06:43:37.969522 | fcf0a905-1ce7-45d2-bf65-f1d04dab395e ==============================
[0m06:43:37.969522 [info ] [MainThread]: Running with dbt=1.7.2
[0m06:43:37.970266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:43:37.989671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcf0a905-1ce7-45d2-bf65-f1d04dab395e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1153db040>]}
[0m06:43:37.990400 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m06:43:37.991068 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m06:43:37.991533 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.025021832, "process_user_time": 2.057378, "process_kernel_time": 0.175325, "process_mem_max_rss": "145326080", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:43:37.991986 [debug] [MainThread]: Command `cli deps` succeeded at 06:43:37.991860 after 0.03 seconds
[0m06:43:37.992357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ac74c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b9f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115ae9810>]}
[0m06:43:37.992755 [debug] [MainThread]: Flushing usage events
[0m06:44:26.767691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d4b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fabeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fabaf0>]}


============================== 06:44:26.770781 | 49ef6709-2866-4410-a8ba-9423330cc2c3 ==============================
[0m06:44:26.770781 [info ] [MainThread]: Running with dbt=1.7.2
[0m06:44:26.771175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:44:26.983871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49ef6709-2866-4410-a8ba-9423330cc2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa93f0>]}
[0m06:44:27.033315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49ef6709-2866-4410-a8ba-9423330cc2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108053730>]}
[0m06:44:27.034135 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m06:44:27.044067 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m06:44:27.073459 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:44:27.073823 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:44:27.077719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49ef6709-2866-4410-a8ba-9423330cc2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087ba800>]}
[0m06:44:27.078526 [info ] [MainThread]: Performance info: /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/target/perf_info.json
[0m06:44:27.084764 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 0.35157928, "process_user_time": 1.427786, "process_kernel_time": 0.160263, "process_mem_max_rss": "136806400", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:44:27.085158 [debug] [MainThread]: Command `cli parse` succeeded at 06:44:27.085062 after 0.35 seconds
[0m06:44:27.085452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d4b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108053730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087898a0>]}
[0m06:44:27.085726 [debug] [MainThread]: Flushing usage events
[0m06:44:27.460714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e74f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108788a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108789930>]}


============================== 06:44:27.461524 | da4cf051-7885-43b7-8ee8-8117a136b59a ==============================
[0m06:44:27.461524 [info ] [MainThread]: Running with dbt=1.7.2
[0m06:44:27.462202 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:44:27.479682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da4cf051-7885-43b7-8ee8-8117a136b59a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10802f490>]}
[0m06:44:27.480391 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m06:44:27.481098 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m06:44:27.481599 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.023504876, "process_user_time": 1.468231, "process_kernel_time": 0.171732, "process_mem_max_rss": "140820480", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:44:27.482082 [debug] [MainThread]: Command `cli deps` succeeded at 06:44:27.481955 after 0.02 seconds
[0m06:44:27.482503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e74f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080f9930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108788550>]}
[0m06:44:27.482929 [debug] [MainThread]: Flushing usage events
[0m06:44:27.826742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d7fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108788370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108788070>]}


============================== 06:44:27.827666 | 98f3bbc2-8823-4f28-9039-d78ad7c75db3 ==============================
[0m06:44:27.827666 [info ] [MainThread]: Running with dbt=1.7.2
[0m06:44:27.828455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:44:27.850487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98f3bbc2-8823-4f28-9039-d78ad7c75db3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057162c0>]}
[0m06:44:27.851799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98f3bbc2-8823-4f28-9039-d78ad7c75db3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108137370>]}
[0m06:44:27.852287 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m06:44:27.855030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98f3bbc2-8823-4f28-9039-d78ad7c75db3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084355d0>]}
[0m06:44:27.855552 [info ] [MainThread]: Found 2 models, 3 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m06:44:27.855977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98f3bbc2-8823-4f28-9039-d78ad7c75db3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108135c60>]}
[0m06:44:27.857359 [info ] [MainThread]: 
[0m06:44:27.857777 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:44:27.858482 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m06:44:27.862957 [debug] [ThreadPool]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m06:44:28.113094 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m06:44:28.113447 [debug] [ThreadPool]: On list_dev: 
    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m06:44:28.113686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:44:28.119316 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:44:28.119574 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m06:44:28.119812 [info ] [MainThread]: 
[0m06:44:28.120076 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m06:44:28.120400 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "/tmp/local/sample_dbt_project//dev.duckdb": No such file or directory
[0m06:44:28.120729 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.29671, "process_user_time": 1.763216, "process_kernel_time": 0.189102, "process_mem_max_rss": "144162816", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:44:28.121052 [debug] [MainThread]: Command `cli run` failed at 06:44:28.120964 after 0.30 seconds
[0m06:44:28.121300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d7fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f0f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108135d80>]}
[0m06:44:28.121558 [debug] [MainThread]: Flushing usage events
[0m06:45:17.692732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106657fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0bb50>]}


============================== 06:45:17.695751 | 0d733d53-d117-4da5-a9f2-f832d3cfd550 ==============================
[0m06:45:17.695751 [info ] [MainThread]: Running with dbt=1.7.2
[0m06:45:17.696163 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'send_anonymous_usage_stats': 'True'}
[0m06:45:17.891648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d733d53-d117-4da5-a9f2-f832d3cfd550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e093f0>]}
[0m06:45:17.938631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d733d53-d117-4da5-a9f2-f832d3cfd550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108091750>]}
[0m06:45:17.939540 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m06:45:17.949236 [debug] [MainThread]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m06:45:17.955860 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m06:45:17.956254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0d733d53-d117-4da5-a9f2-f832d3cfd550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb0070>]}
[0m06:45:18.425830 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m06:45:18.435005 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m06:45:18.563504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d733d53-d117-4da5-a9f2-f832d3cfd550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108213df0>]}
[0m06:45:18.564184 [info ] [MainThread]: Performance info: /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/target/perf_info.json
[0m06:45:18.570484 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 0.91269016, "process_user_time": 1.955836, "process_kernel_time": 0.152723, "process_mem_max_rss": "139247616", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:45:18.570882 [debug] [MainThread]: Command `cli parse` succeeded at 06:45:18.570776 after 0.91 seconds
[0m06:45:18.571182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106657fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10834bbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108192ef0>]}
[0m06:45:18.571468 [debug] [MainThread]: Flushing usage events
[0m06:45:19.018153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106133550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d6fee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d6ce80>]}


============================== 06:45:19.018598 | 199dadab-9259-4f58-b7f2-7666fca2d600 ==============================
[0m06:45:19.018598 [info ] [MainThread]: Running with dbt=1.7.2
[0m06:45:19.019024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'send_anonymous_usage_stats': 'True'}
[0m06:45:19.031344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '199dadab-9259-4f58-b7f2-7666fca2d600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e8dab0>]}
[0m06:45:19.031875 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m06:45:19.032402 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m06:45:19.032780 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.015773583, "process_user_time": 1.994877, "process_kernel_time": 0.161457, "process_mem_max_rss": "143245312", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:45:19.033155 [debug] [MainThread]: Command `cli deps` succeeded at 06:45:19.033048 after 0.02 seconds
[0m06:45:19.033458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106133550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080924d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f58640>]}
[0m06:45:19.033774 [debug] [MainThread]: Flushing usage events
[0m06:45:19.379143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10668bca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10668bb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108211b40>]}


============================== 06:45:19.380009 | 3ae50bd5-38ac-4aca-8c02-9ce5f5c3ef2f ==============================
[0m06:45:19.380009 [info ] [MainThread]: Running with dbt=1.7.2
[0m06:45:19.380821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'send_anonymous_usage_stats': 'True'}
[0m06:45:19.403589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ae50bd5-38ac-4aca-8c02-9ce5f5c3ef2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d6cfa0>]}
[0m06:45:19.404928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ae50bd5-38ac-4aca-8c02-9ce5f5c3ef2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d36d10>]}
[0m06:45:19.405429 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m06:45:19.407086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ae50bd5-38ac-4aca-8c02-9ce5f5c3ef2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108212d40>]}
[0m06:45:19.407521 [info ] [MainThread]: Found 2 models, 3 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m06:45:19.407893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ae50bd5-38ac-4aca-8c02-9ce5f5c3ef2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082133a0>]}
[0m06:45:19.409134 [info ] [MainThread]: 
[0m06:45:19.409553 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:45:19.410244 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m06:45:19.414800 [debug] [ThreadPool]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m06:45:19.664398 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m06:45:19.664731 [debug] [ThreadPool]: On list_dev: 
    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m06:45:19.664964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:45:19.680761 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:45:19.682918 [debug] [ThreadPool]: On list_dev: Close
[0m06:45:19.684212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m06:45:19.684486 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m06:45:19.687008 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m06:45:19.687242 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m06:45:19.687447 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:45:19.689783 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:45:19.690016 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m06:45:19.690223 [debug] [ThreadPool]: On create_dev_main: create schema if not exists "dev"."main"
[0m06:45:19.690822 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:45:19.691313 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m06:45:19.691530 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m06:45:19.691740 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m06:45:19.691980 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:45:19.692190 [debug] [ThreadPool]: On create_dev_main: Close
[0m06:45:19.693298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m06:45:19.696678 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m06:45:19.696932 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m06:45:19.697160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:45:19.699310 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:45:19.699557 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m06:45:19.699788 [debug] [ThreadPool]: On list_dev_main: select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m06:45:19.711240 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:45:19.714516 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m06:45:19.715549 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m06:45:19.715781 [debug] [ThreadPool]: On list_dev_main: Close
[0m06:45:19.717322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ae50bd5-38ac-4aca-8c02-9ce5f5c3ef2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10817ab90>]}
[0m06:45:19.717641 [debug] [MainThread]: Using duckdb connection "master"
[0m06:45:19.717856 [debug] [MainThread]: On master: BEGIN
[0m06:45:19.718061 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:45:19.720227 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:45:19.720455 [debug] [MainThread]: On master: COMMIT
[0m06:45:19.720664 [debug] [MainThread]: Using duckdb connection "master"
[0m06:45:19.720868 [debug] [MainThread]: On master: COMMIT
[0m06:45:19.721092 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:45:19.721299 [debug] [MainThread]: On master: Close
[0m06:45:19.722273 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:45:19.722608 [info ] [MainThread]: 
[0m06:45:19.724061 [debug] [Thread-1 (]: Began running node model.duckdb_sample_project.my_first_dbt_model
[0m06:45:19.724411 [info ] [Thread-1 (]: 1 of 2 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m06:45:19.724679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.duckdb_sample_project.my_first_dbt_model)
[0m06:45:19.724939 [debug] [Thread-1 (]: Began compiling node model.duckdb_sample_project.my_first_dbt_model
[0m06:45:19.729369 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_sample_project.my_first_dbt_model"
[0m06:45:19.729892 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_first_dbt_model (compile): 06:45:19.725205 => 06:45:19.729743
[0m06:45:19.730163 [debug] [Thread-1 (]: Began executing node model.duckdb_sample_project.my_first_dbt_model
[0m06:45:19.749012 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_sample_project.my_first_dbt_model"
[0m06:45:19.753519 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m06:45:19.753809 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: BEGIN
[0m06:45:19.754059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:45:19.756569 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:45:19.756842 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m06:45:19.757094 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: 
  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m06:45:19.759901 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:45:19.763320 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m06:45:19.763584 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m06:45:19.764118 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:45:19.765822 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m06:45:19.766086 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m06:45:19.766396 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:45:19.777444 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: COMMIT
[0m06:45:19.777746 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m06:45:19.777994 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: COMMIT
[0m06:45:19.778890 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:45:19.782389 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_first_dbt_model"
[0m06:45:19.782674 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m06:45:19.783231 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:45:19.784072 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_first_dbt_model (execute): 06:45:19.730327 => 06:45:19.783940
[0m06:45:19.784327 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_first_dbt_model: Close
[0m06:45:19.786841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ae50bd5-38ac-4aca-8c02-9ce5f5c3ef2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108710e80>]}
[0m06:45:19.787220 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m06:45:19.787599 [debug] [Thread-1 (]: Finished running node model.duckdb_sample_project.my_first_dbt_model
[0m06:45:19.788058 [debug] [Thread-1 (]: Began running node model.duckdb_sample_project.my_second_dbt_model
[0m06:45:19.788387 [info ] [Thread-1 (]: 2 of 2 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m06:45:19.788644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.duckdb_sample_project.my_first_dbt_model, now model.duckdb_sample_project.my_second_dbt_model)
[0m06:45:19.788906 [debug] [Thread-1 (]: Began compiling node model.duckdb_sample_project.my_second_dbt_model
[0m06:45:19.790454 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_sample_project.my_second_dbt_model"
[0m06:45:19.790896 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_second_dbt_model (compile): 06:45:19.789057 => 06:45:19.790760
[0m06:45:19.791148 [debug] [Thread-1 (]: Began executing node model.duckdb_sample_project.my_second_dbt_model
[0m06:45:19.801713 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_sample_project.my_second_dbt_model"
[0m06:45:19.802240 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m06:45:19.802507 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: BEGIN
[0m06:45:19.802753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:45:19.805235 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:45:19.805493 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m06:45:19.805740 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: 
  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m06:45:19.806071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:45:19.807980 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m06:45:19.808254 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m06:45:19.808595 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:45:19.810306 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m06:45:19.810553 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m06:45:19.810841 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:45:19.811985 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: COMMIT
[0m06:45:19.812238 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m06:45:19.812467 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: COMMIT
[0m06:45:19.812843 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:45:19.814310 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_sample_project.my_second_dbt_model"
[0m06:45:19.814561 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m06:45:19.814886 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m06:45:19.815649 [debug] [Thread-1 (]: Timing info for model.duckdb_sample_project.my_second_dbt_model (execute): 06:45:19.791319 => 06:45:19.815519
[0m06:45:19.815901 [debug] [Thread-1 (]: On model.duckdb_sample_project.my_second_dbt_model: Close
[0m06:45:19.817243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ae50bd5-38ac-4aca-8c02-9ce5f5c3ef2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10871a740>]}
[0m06:45:19.817667 [info ] [Thread-1 (]: 2 of 2 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.03s]
[0m06:45:19.818052 [debug] [Thread-1 (]: Finished running node model.duckdb_sample_project.my_second_dbt_model
[0m06:45:19.818716 [debug] [MainThread]: Using duckdb connection "master"
[0m06:45:19.818947 [debug] [MainThread]: On master: BEGIN
[0m06:45:19.819157 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:45:19.821458 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:45:19.821689 [debug] [MainThread]: On master: COMMIT
[0m06:45:19.821902 [debug] [MainThread]: Using duckdb connection "master"
[0m06:45:19.822108 [debug] [MainThread]: On master: COMMIT
[0m06:45:19.822332 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:45:19.822539 [debug] [MainThread]: On master: Close
[0m06:45:19.823346 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:45:19.823572 [debug] [MainThread]: Connection 'model.duckdb_sample_project.my_second_dbt_model' was properly closed.
[0m06:45:19.823798 [info ] [MainThread]: 
[0m06:45:19.824046 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m06:45:19.824519 [debug] [MainThread]: Command end result
[0m06:45:19.829639 [info ] [MainThread]: 
[0m06:45:19.829919 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:45:19.830158 [info ] [MainThread]: 
[0m06:45:19.830408 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:45:19.830724 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.45428476, "process_user_time": 2.423419, "process_kernel_time": 0.191433, "process_mem_max_rss": "154271744", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:45:19.831048 [debug] [MainThread]: Command `cli run` succeeded at 06:45:19.830962 after 0.45 seconds
[0m06:45:19.831317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10668bca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d36d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082a17e0>]}
[0m06:45:19.831585 [debug] [MainThread]: Flushing usage events
[0m06:45:20.178697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d6db40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10812e2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10812c940>]}


============================== 06:45:20.179475 | 1bffe82e-20ac-4e87-82b4-b7a6a05bc78a ==============================
[0m06:45:20.179475 [info ] [MainThread]: Running with dbt=1.7.2
[0m06:45:20.180252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project', 'log_path': '/Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb/sample_dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --rootdir /Users/ajsteers/Source/airbyte/airbyte-integrations/connectors/source-dbt-duckdb --color=yes', 'send_anonymous_usage_stats': 'True'}
[0m06:45:20.201803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bffe82e-20ac-4e87-82b4-b7a6a05bc78a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10668bb80>]}
[0m06:45:20.203220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bffe82e-20ac-4e87-82b4-b7a6a05bc78a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d35270>]}
[0m06:45:20.203704 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m06:45:20.205523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bffe82e-20ac-4e87-82b4-b7a6a05bc78a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108352cb0>]}
[0m06:45:20.205973 [info ] [MainThread]: Found 2 models, 3 tests, 0 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m06:45:20.206350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bffe82e-20ac-4e87-82b4-b7a6a05bc78a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108350400>]}
[0m06:45:20.207319 [info ] [MainThread]: 
[0m06:45:20.207747 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:45:20.208432 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m06:45:20.213207 [debug] [ThreadPool]: checksum: 61e99fc04fd80d06ce91efefd25c0802dcce8a048167599a1a188233d6ce8ed9, vars: {}, profile: , target: , version: 1.7.2
[0m06:45:20.465487 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m06:45:20.465823 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m06:45:20.466051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:45:20.468771 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:45:20.469023 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m06:45:20.469250 [debug] [ThreadPool]: On list_dev_main: select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m06:45:20.478836 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:45:20.481281 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m06:45:20.481896 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m06:45:20.482118 [debug] [ThreadPool]: On list_dev_main: Close
[0m06:45:20.483863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bffe82e-20ac-4e87-82b4-b7a6a05bc78a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108212620>]}
[0m06:45:20.484196 [debug] [MainThread]: Using duckdb connection "master"
[0m06:45:20.484416 [debug] [MainThread]: On master: BEGIN
[0m06:45:20.484623 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:45:20.486971 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:45:20.487205 [debug] [MainThread]: On master: COMMIT
[0m06:45:20.487415 [debug] [MainThread]: Using duckdb connection "master"
[0m06:45:20.487618 [debug] [MainThread]: On master: COMMIT
[0m06:45:20.487843 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:45:20.488050 [debug] [MainThread]: On master: Close
[0m06:45:20.488909 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:45:20.489203 [info ] [MainThread]: 
[0m06:45:20.489905 [debug] [Thread-5 (]: Began running node test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778
[0m06:45:20.490168 [info ] [Thread-5 (]: 1 of 3 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m06:45:20.490424 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly list_dev_main, now test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778)
[0m06:45:20.490672 [debug] [Thread-5 (]: Began compiling node test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778
[0m06:45:20.497636 [debug] [Thread-5 (]: Writing injected SQL for node "test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778"
[0m06:45:20.498179 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778 (compile): 06:45:20.490832 => 06:45:20.498042
[0m06:45:20.498444 [debug] [Thread-5 (]: Began executing node test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778
[0m06:45:20.506549 [debug] [Thread-5 (]: Writing runtime sql for node "test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778"
[0m06:45:20.507025 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778"
[0m06:45:20.507283 [debug] [Thread-5 (]: On test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m06:45:20.507524 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m06:45:20.510034 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m06:45:20.510325 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778"
[0m06:45:20.510646 [debug] [Thread-5 (]: On test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."main"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m06:45:20.512778 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m06:45:20.514207 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778 (execute): 06:45:20.498605 => 06:45:20.514054
[0m06:45:20.514496 [debug] [Thread-5 (]: On test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m06:45:20.515121 [debug] [Thread-5 (]: Failed to rollback 'test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778'
[0m06:45:20.515358 [debug] [Thread-5 (]: On test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778: Close
[0m06:45:20.516300 [info ] [Thread-5 (]: 1 of 3 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.03s]
[0m06:45:20.516713 [debug] [Thread-5 (]: Finished running node test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778
[0m06:45:20.517020 [debug] [Thread-5 (]: Began running node test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321
[0m06:45:20.517332 [info ] [Thread-5 (]: 2 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m06:45:20.517598 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.duckdb_sample_project.not_null_my_second_dbt_model_id.151b76d778, now test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321)
[0m06:45:20.517852 [debug] [Thread-5 (]: Began compiling node test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321
[0m06:45:20.521456 [debug] [Thread-5 (]: Writing injected SQL for node "test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321"
[0m06:45:20.521956 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321 (compile): 06:45:20.518006 => 06:45:20.521815
[0m06:45:20.522212 [debug] [Thread-5 (]: Began executing node test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321
[0m06:45:20.523546 [debug] [Thread-5 (]: Writing runtime sql for node "test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321"
[0m06:45:20.523917 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321"
[0m06:45:20.524156 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m06:45:20.524385 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m06:45:20.526708 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m06:45:20.526982 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321"
[0m06:45:20.527239 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."main"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m06:45:20.529519 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m06:45:20.530465 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321 (execute): 06:45:20.522362 => 06:45:20.530310
[0m06:45:20.530744 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m06:45:20.531417 [debug] [Thread-5 (]: Failed to rollback 'test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321'
[0m06:45:20.531669 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321: Close
[0m06:45:20.532731 [info ] [Thread-5 (]: 2 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.02s]
[0m06:45:20.533200 [debug] [Thread-5 (]: Finished running node test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321
[0m06:45:20.533516 [debug] [Thread-5 (]: Began running node test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493
[0m06:45:20.533858 [info ] [Thread-5 (]: 3 of 3 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m06:45:20.534150 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.duckdb_sample_project.unique_my_first_dbt_model_id.16e066b321, now test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493)
[0m06:45:20.534409 [debug] [Thread-5 (]: Began compiling node test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493
[0m06:45:20.536973 [debug] [Thread-5 (]: Writing injected SQL for node "test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m06:45:20.537442 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493 (compile): 06:45:20.534577 => 06:45:20.537305
[0m06:45:20.537690 [debug] [Thread-5 (]: Began executing node test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493
[0m06:45:20.539962 [debug] [Thread-5 (]: Writing runtime sql for node "test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m06:45:20.540349 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m06:45:20.540586 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m06:45:20.540813 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m06:45:20.543316 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m06:45:20.543628 [debug] [Thread-5 (]: Using duckdb connection "test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m06:45:20.543943 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."main"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m06:45:20.544639 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m06:45:20.545549 [debug] [Thread-5 (]: Timing info for test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493 (execute): 06:45:20.537840 => 06:45:20.545397
[0m06:45:20.545821 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m06:45:20.546447 [debug] [Thread-5 (]: Failed to rollback 'test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493'
[0m06:45:20.546697 [debug] [Thread-5 (]: On test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m06:45:20.547608 [info ] [Thread-5 (]: 3 of 3 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.01s]
[0m06:45:20.547985 [debug] [Thread-5 (]: Finished running node test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493
[0m06:45:20.548617 [debug] [MainThread]: Using duckdb connection "master"
[0m06:45:20.548915 [debug] [MainThread]: On master: BEGIN
[0m06:45:20.549139 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:45:20.551769 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:45:20.552049 [debug] [MainThread]: On master: COMMIT
[0m06:45:20.552273 [debug] [MainThread]: Using duckdb connection "master"
[0m06:45:20.552489 [debug] [MainThread]: On master: COMMIT
[0m06:45:20.552727 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:45:20.552949 [debug] [MainThread]: On master: Close
[0m06:45:20.553817 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:45:20.554040 [debug] [MainThread]: Connection 'test.duckdb_sample_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m06:45:20.554278 [info ] [MainThread]: 
[0m06:45:20.554533 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m06:45:20.555071 [debug] [MainThread]: Command end result
[0m06:45:20.559544 [info ] [MainThread]: 
[0m06:45:20.559841 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:45:20.560100 [info ] [MainThread]: 
[0m06:45:20.560342 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:45:20.560653 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.384165, "process_user_time": 2.806758, "process_kernel_time": 0.215384, "process_mem_max_rss": "159809536", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:45:20.560943 [debug] [MainThread]: Command `cli test` succeeded at 06:45:20.560865 after 0.38 seconds
[0m06:45:20.561186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d6db40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d35270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108212e30>]}
[0m06:45:20.561438 [debug] [MainThread]: Flushing usage events
